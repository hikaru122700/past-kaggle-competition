{"cells":[{"cell_type":"code","execution_count":165,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2199,"status":"ok","timestamp":1731573827227,"user":{"displayName":"ねこ","userId":"00794682924380388788"},"user_tz":-540},"id":"Iy46qAQDW7P2","outputId":"9005e0bb-3e60-49b8-a150-33e5e76c159c"},"outputs":[{"name":"stdout","output_type":"stream","text":["Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(\"/content/drive\", force_remount=True).\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","execution_count":166,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":14386,"status":"ok","timestamp":1731573841609,"user":{"displayName":"ねこ","userId":"00794682924380388788"},"user_tz":-540},"id":"gH3_DqquXRjH","outputId":"043ac285-37d8-4f57-cf37-470d4aa8eeed"},"outputs":[{"name":"stdout","output_type":"stream","text":["Requirement already satisfied: optuna in /usr/local/lib/python3.10/dist-packages (4.1.0)\n","Requirement already satisfied: alembic\u003e=1.5.0 in /usr/local/lib/python3.10/dist-packages (from optuna) (1.14.0)\n","Requirement already satisfied: colorlog in /usr/local/lib/python3.10/dist-packages (from optuna) (6.9.0)\n","Requirement already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (from optuna) (1.26.4)\n","Requirement already satisfied: packaging\u003e=20.0 in /usr/local/lib/python3.10/dist-packages (from optuna) (24.1)\n","Requirement already satisfied: sqlalchemy\u003e=1.4.2 in /usr/local/lib/python3.10/dist-packages (from optuna) (2.0.35)\n","Requirement already satisfied: tqdm in /usr/local/lib/python3.10/dist-packages (from optuna) (4.66.5)\n","Requirement already satisfied: PyYAML in /usr/local/lib/python3.10/dist-packages (from optuna) (6.0.2)\n","Requirement already satisfied: Mako in /usr/local/lib/python3.10/dist-packages (from alembic\u003e=1.5.0-\u003eoptuna) (1.3.6)\n","Requirement already satisfied: typing-extensions\u003e=4 in /usr/local/lib/python3.10/dist-packages (from alembic\u003e=1.5.0-\u003eoptuna) (4.12.2)\n","Requirement already satisfied: greenlet!=0.4.17 in /usr/local/lib/python3.10/dist-packages (from sqlalchemy\u003e=1.4.2-\u003eoptuna) (3.1.0)\n","Requirement already satisfied: MarkupSafe\u003e=0.9.2 in /usr/local/lib/python3.10/dist-packages (from Mako-\u003ealembic\u003e=1.5.0-\u003eoptuna) (2.1.5)\n","Requirement already satisfied: catboost in /usr/local/lib/python3.10/dist-packages (1.2.7)\n","Requirement already satisfied: graphviz in /usr/local/lib/python3.10/dist-packages (from catboost) (0.20.3)\n","Requirement already satisfied: matplotlib in /usr/local/lib/python3.10/dist-packages (from catboost) (3.7.1)\n","Requirement already satisfied: numpy\u003c2.0,\u003e=1.16.0 in /usr/local/lib/python3.10/dist-packages (from catboost) (1.26.4)\n","Requirement already satisfied: pandas\u003e=0.24 in /usr/local/lib/python3.10/dist-packages (from catboost) (2.1.4)\n","Requirement already satisfied: scipy in /usr/local/lib/python3.10/dist-packages (from catboost) (1.13.1)\n","Requirement already satisfied: plotly in /usr/local/lib/python3.10/dist-packages (from catboost) (5.24.1)\n","Requirement already satisfied: six in /usr/local/lib/python3.10/dist-packages (from catboost) (1.16.0)\n","Requirement already satisfied: python-dateutil\u003e=2.8.2 in /usr/local/lib/python3.10/dist-packages (from pandas\u003e=0.24-\u003ecatboost) (2.8.2)\n","Requirement already satisfied: pytz\u003e=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas\u003e=0.24-\u003ecatboost) (2024.2)\n","Requirement already satisfied: tzdata\u003e=2022.1 in /usr/local/lib/python3.10/dist-packages (from pandas\u003e=0.24-\u003ecatboost) (2024.1)\n","Requirement already satisfied: contourpy\u003e=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib-\u003ecatboost) (1.3.0)\n","Requirement already satisfied: cycler\u003e=0.10 in /usr/local/lib/python3.10/dist-packages (from matplotlib-\u003ecatboost) (0.12.1)\n","Requirement already satisfied: fonttools\u003e=4.22.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib-\u003ecatboost) (4.53.1)\n","Requirement already satisfied: kiwisolver\u003e=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib-\u003ecatboost) (1.4.7)\n","Requirement already satisfied: packaging\u003e=20.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib-\u003ecatboost) (24.1)\n","Requirement already satisfied: pillow\u003e=6.2.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib-\u003ecatboost) (10.4.0)\n","Requirement already satisfied: pyparsing\u003e=2.3.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib-\u003ecatboost) (3.1.4)\n","Requirement already satisfied: tenacity\u003e=6.2.0 in /usr/local/lib/python3.10/dist-packages (from plotly-\u003ecatboost) (9.0.0)\n","Requirement already satisfied: lightgbm in /usr/local/lib/python3.10/dist-packages (4.5.0)\n","Requirement already satisfied: numpy\u003e=1.17.0 in /usr/local/lib/python3.10/dist-packages (from lightgbm) (1.26.4)\n","Requirement already satisfied: scipy in /usr/local/lib/python3.10/dist-packages (from lightgbm) (1.13.1)\n","Requirement already satisfied: xgboost in /usr/local/lib/python3.10/dist-packages (2.1.1)\n","Requirement already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (from xgboost) (1.26.4)\n","Requirement already satisfied: nvidia-nccl-cu12 in /usr/local/lib/python3.10/dist-packages (from xgboost) (2.23.4)\n","Requirement already satisfied: scipy in /usr/local/lib/python3.10/dist-packages (from xgboost) (1.13.1)\n","\u001b[31mERROR: Could not find a version that satisfies the requirement histgb (from versions: none)\u001b[0m\u001b[31m\n","\u001b[0m\u001b[31mERROR: No matching distribution found for histgb\u001b[0m\u001b[31m\n","\u001b[0m"]}],"source":["!pip install optuna\n","!pip install catboost\n","!pip install lightgbm\n","!pip install xgboost\n","!pip install histgb"]},{"cell_type":"code","execution_count":167,"metadata":{"executionInfo":{"elapsed":14,"status":"ok","timestamp":1731573841610,"user":{"displayName":"ねこ","userId":"00794682924380388788"},"user_tz":-540},"id":"uK27EqrqXFqd"},"outputs":[],"source":["import warnings\n","warnings.filterwarnings(\"ignore\")\n","\n","import numpy as np\n","import pandas as pd\n","from tqdm import tqdm\n","import joblib\n","\n","from lightgbm import LGBMRegressor\n","from catboost import CatBoostRegressor\n","from xgboost import XGBRegressor\n","from sklearn.ensemble import HistGradientBoostingRegressor\n","\n","\n","from sklearn.model_selection import KFold\n","from sklearn.metrics import *\n","\n","import gc\n","gc.collect()\n","\n","import os\n","\n","from sklearn.neighbors import KNeighborsRegressor\n","from sklearn.preprocessing import StandardScaler\n","from sklearn.metrics import mean_squared_error\n","import optuna"]},{"cell_type":"code","execution_count":168,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":417},"executionInfo":{"elapsed":551,"status":"ok","timestamp":1731573842149,"user":{"displayName":"ねこ","userId":"00794682924380388788"},"user_tz":-540},"id":"-SjiC8YhXGOy","outputId":"8a84a243-6448-4d95-a5f8-67b1a65f9759"},"outputs":[{"data":{"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"train_df"},"text/html":["\n","  \u003cdiv id=\"df-b09760a3-cd53-4f08-8136-d852e46b1cd1\" class=\"colab-df-container\"\u003e\n","    \u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eFacilityName\u003c/th\u003e\n","      \u003cth\u003eLatitude\u003c/th\u003e\n","      \u003cth\u003eLongitude\u003c/th\u003e\n","      \u003cth\u003eLocationAddress\u003c/th\u003e\n","      \u003cth\u003eCity\u003c/th\u003e\n","      \u003cth\u003eState\u003c/th\u003e\n","      \u003cth\u003eZIP\u003c/th\u003e\n","      \u003cth\u003eCounty\u003c/th\u003e\n","      \u003cth\u003eFIPScode\u003c/th\u003e\n","      \u003cth\u003ePrimaryNAICS\u003c/th\u003e\n","      \u003cth\u003eSecondPrimaryNAICS\u003c/th\u003e\n","      \u003cth\u003eIndustryType\u003c/th\u003e\n","      \u003cth\u003eTRI_Air_Emissions_10_in_lbs\u003c/th\u003e\n","      \u003cth\u003eTRI_Air_Emissions_11_in_lbs\u003c/th\u003e\n","      \u003cth\u003eTRI_Air_Emissions_12_in_lbs\u003c/th\u003e\n","      \u003cth\u003eTRI_Air_Emissions_13_in_lbs\u003c/th\u003e\n","      \u003cth\u003eGHG_Direct_Emissions_10_in_metric_tons\u003c/th\u003e\n","      \u003cth\u003eGHG_Direct_Emissions_11_in_metric_tons\u003c/th\u003e\n","      \u003cth\u003eGHG_Direct_Emissions_12_in_metric_tons\u003c/th\u003e\n","      \u003cth\u003eGHG_Direct_Emissions_13_in_metric_tons\u003c/th\u003e\n","      \u003cth\u003eGHG_Direct_Emissions_14_in_metric_tons\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e0\u003c/th\u003e\n","      \u003ctd\u003eVISCOFAN USA INC\u003c/td\u003e\n","      \u003ctd\u003e40.141389\u003c/td\u003e\n","      \u003ctd\u003e-87.581111\u003c/td\u003e\n","      \u003ctd\u003e915 N MICHIGAN AVE\u003c/td\u003e\n","      \u003ctd\u003eDANVILLE\u003c/td\u003e\n","      \u003ctd\u003eIL\u003c/td\u003e\n","      \u003ctd\u003e61832\u003c/td\u003e\n","      \u003ctd\u003eVERMILION\u003c/td\u003e\n","      \u003ctd\u003e17183.0\u003c/td\u003e\n","      \u003ctd\u003e326121\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eOther\u003c/td\u003e\n","      \u003ctd\u003e31566.709644\u003c/td\u003e\n","      \u003ctd\u003e26644.986107\u003c/td\u003e\n","      \u003ctd\u003e23410.379903\u003c/td\u003e\n","      \u003ctd\u003e31809.857564\u003c/td\u003e\n","      \u003ctd\u003e64816.958901\u003c/td\u003e\n","      \u003ctd\u003e36588.744606\u003c/td\u003e\n","      \u003ctd\u003e37907.936721\u003c/td\u003e\n","      \u003ctd\u003e45598.125851\u003c/td\u003e\n","      \u003ctd\u003e52973.139946\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e1\u003c/th\u003e\n","      \u003ctd\u003eCORNWELL STATION - DOMINION TRANSMISSION, INC\u003c/td\u003e\n","      \u003ctd\u003e38.475305\u003c/td\u003e\n","      \u003ctd\u003e-81.278957\u003c/td\u003e\n","      \u003ctd\u003e200 RIVER HAVEN ROAD\u003c/td\u003e\n","      \u003ctd\u003eCLENDENIN\u003c/td\u003e\n","      \u003ctd\u003eWV\u003c/td\u003e\n","      \u003ctd\u003e25045-9304\u003c/td\u003e\n","      \u003ctd\u003eKANAWHA\u003c/td\u003e\n","      \u003ctd\u003e54039.0\u003c/td\u003e\n","      \u003ctd\u003e486210\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003ePetroleum and Natural Gas Systems\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e55507.543666\u003c/td\u003e\n","      \u003ctd\u003e72387.334115\u003c/td\u003e\n","      \u003ctd\u003e58225.196089\u003c/td\u003e\n","      \u003ctd\u003e76376.547318\u003c/td\u003e\n","      \u003ctd\u003e55910.066617\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e2\u003c/th\u003e\n","      \u003ctd\u003eWEST UNION COMPRESSOR STATION\u003c/td\u003e\n","      \u003ctd\u003e39.299820\u003c/td\u003e\n","      \u003ctd\u003e-80.857170\u003c/td\u003e\n","      \u003ctd\u003e3041 LONG RUN RD.\u003c/td\u003e\n","      \u003ctd\u003eGREENWOOD\u003c/td\u003e\n","      \u003ctd\u003eWV\u003c/td\u003e\n","      \u003ctd\u003e26415\u003c/td\u003e\n","      \u003ctd\u003eRITCHIE\u003c/td\u003e\n","      \u003ctd\u003e54085.0\u003c/td\u003e\n","      \u003ctd\u003e211112\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003ePetroleum and Natural Gas Systems\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e55679.543214\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e3\u003c/th\u003e\n","      \u003ctd\u003eDOUBLE \"C\" LIMITED\u003c/td\u003e\n","      \u003ctd\u003e35.490363\u003c/td\u003e\n","      \u003ctd\u003e-119.042957\u003c/td\u003e\n","      \u003ctd\u003e10245 OILFIELD ROAD\u003c/td\u003e\n","      \u003ctd\u003eBAKERSFIELD\u003c/td\u003e\n","      \u003ctd\u003eCA\u003c/td\u003e\n","      \u003ctd\u003e93308\u003c/td\u003e\n","      \u003ctd\u003eKERN\u003c/td\u003e\n","      \u003ctd\u003e6029.0\u003c/td\u003e\n","      \u003ctd\u003e221112\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003ePower Plants\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e54811.222708\u003c/td\u003e\n","      \u003ctd\u003e69339.923002\u003c/td\u003e\n","      \u003ctd\u003e63647.340038\u003c/td\u003e\n","      \u003ctd\u003e53799.011225\u003c/td\u003e\n","      \u003ctd\u003e61411.902782\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4\u003c/th\u003e\n","      \u003ctd\u003eLAKESHORE PLANT\u003c/td\u003e\n","      \u003ctd\u003e41.532802\u003c/td\u003e\n","      \u003ctd\u003e-81.636448\u003c/td\u003e\n","      \u003ctd\u003e6800 S MARGINAL RD\u003c/td\u003e\n","      \u003ctd\u003eCLEVELAND\u003c/td\u003e\n","      \u003ctd\u003eOH\u003c/td\u003e\n","      \u003ctd\u003e441031047\u003c/td\u003e\n","      \u003ctd\u003eCUYAHOGA\u003c/td\u003e\n","      \u003ctd\u003e39035.0\u003c/td\u003e\n","      \u003ctd\u003e221112\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003ePower Plants\u003c/td\u003e\n","      \u003ctd\u003e29553.796627\u003c/td\u003e\n","      \u003ctd\u003e28337.832145\u003c/td\u003e\n","      \u003ctd\u003e30840.825454\u003c/td\u003e\n","      \u003ctd\u003e25153.901905\u003c/td\u003e\n","      \u003ctd\u003e81812.306362\u003c/td\u003e\n","      \u003ctd\u003e53823.561587\u003c/td\u003e\n","      \u003ctd\u003e77391.157768\u003c/td\u003e\n","      \u003ctd\u003e17662.966241\u003c/td\u003e\n","      \u003ctd\u003e43100.469774\u003c/td\u003e\n","    \u003c/tr\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e\n","    \u003cdiv class=\"colab-df-buttons\"\u003e\n","\n","  \u003cdiv class=\"colab-df-container\"\u003e\n","    \u003cbutton class=\"colab-df-convert\" onclick=\"convertToInteractive('df-b09760a3-cd53-4f08-8136-d852e46b1cd1')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\"\u003e\n","\n","  \u003csvg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\"\u003e\n","    \u003cpath d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/\u003e\n","  \u003c/svg\u003e\n","    \u003c/button\u003e\n","\n","  \u003cstyle\u003e\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  \u003c/style\u003e\n","\n","    \u003cscript\u003e\n","      const buttonEl =\n","        document.querySelector('#df-b09760a3-cd53-4f08-8136-d852e46b1cd1 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-b09760a3-cd53-4f08-8136-d852e46b1cd1');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '\u003ca target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb\u003edata table notebook\u003c/a\u003e'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    \u003c/script\u003e\n","  \u003c/div\u003e\n","\n","\n","\u003cdiv id=\"df-fdeb916f-5304-40c3-b040-7350f029b14c\"\u003e\n","  \u003cbutton class=\"colab-df-quickchart\" onclick=\"quickchart('df-fdeb916f-5304-40c3-b040-7350f029b14c')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\"\u003e\n","\n","\u003csvg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\"\u003e\n","    \u003cg\u003e\n","        \u003cpath d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/\u003e\n","    \u003c/g\u003e\n","\u003c/svg\u003e\n","  \u003c/button\u003e\n","\n","\u003cstyle\u003e\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","\u003c/style\u003e\n","\n","  \u003cscript\u003e\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() =\u003e {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-fdeb916f-5304-40c3-b040-7350f029b14c button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  \u003c/script\u003e\n","\u003c/div\u003e\n","\n","    \u003c/div\u003e\n","  \u003c/div\u003e\n"],"text/plain":["                                    FacilityName   Latitude   Longitude  \\\n","0                               VISCOFAN USA INC  40.141389  -87.581111   \n","1  CORNWELL STATION - DOMINION TRANSMISSION, INC  38.475305  -81.278957   \n","2                  WEST UNION COMPRESSOR STATION  39.299820  -80.857170   \n","3                             DOUBLE \"C\" LIMITED  35.490363 -119.042957   \n","4                                LAKESHORE PLANT  41.532802  -81.636448   \n","\n","        LocationAddress         City State         ZIP     County  FIPScode  \\\n","0    915 N MICHIGAN AVE     DANVILLE    IL       61832  VERMILION   17183.0   \n","1  200 RIVER HAVEN ROAD    CLENDENIN    WV  25045-9304    KANAWHA   54039.0   \n","2     3041 LONG RUN RD.    GREENWOOD    WV       26415    RITCHIE   54085.0   \n","3   10245 OILFIELD ROAD  BAKERSFIELD    CA       93308       KERN    6029.0   \n","4    6800 S MARGINAL RD    CLEVELAND    OH   441031047   CUYAHOGA   39035.0   \n","\n","   PrimaryNAICS  SecondPrimaryNAICS                       IndustryType  \\\n","0        326121                 NaN                              Other   \n","1        486210                 NaN  Petroleum and Natural Gas Systems   \n","2        211112                 NaN  Petroleum and Natural Gas Systems   \n","3        221112                 NaN                       Power Plants   \n","4        221112                 NaN                       Power Plants   \n","\n","   TRI_Air_Emissions_10_in_lbs  TRI_Air_Emissions_11_in_lbs  \\\n","0                 31566.709644                 26644.986107   \n","1                          NaN                          NaN   \n","2                          NaN                          NaN   \n","3                          NaN                          NaN   \n","4                 29553.796627                 28337.832145   \n","\n","   TRI_Air_Emissions_12_in_lbs  TRI_Air_Emissions_13_in_lbs  \\\n","0                 23410.379903                 31809.857564   \n","1                          NaN                          NaN   \n","2                          NaN                          NaN   \n","3                          NaN                          NaN   \n","4                 30840.825454                 25153.901905   \n","\n","   GHG_Direct_Emissions_10_in_metric_tons  \\\n","0                            64816.958901   \n","1                            55507.543666   \n","2                                     NaN   \n","3                            54811.222708   \n","4                            81812.306362   \n","\n","   GHG_Direct_Emissions_11_in_metric_tons  \\\n","0                            36588.744606   \n","1                            72387.334115   \n","2                                     NaN   \n","3                            69339.923002   \n","4                            53823.561587   \n","\n","   GHG_Direct_Emissions_12_in_metric_tons  \\\n","0                            37907.936721   \n","1                            58225.196089   \n","2                                     NaN   \n","3                            63647.340038   \n","4                            77391.157768   \n","\n","   GHG_Direct_Emissions_13_in_metric_tons  \\\n","0                            45598.125851   \n","1                            76376.547318   \n","2                                     NaN   \n","3                            53799.011225   \n","4                            17662.966241   \n","\n","   GHG_Direct_Emissions_14_in_metric_tons  \n","0                            52973.139946  \n","1                            55910.066617  \n","2                            55679.543214  \n","3                            61411.902782  \n","4                            43100.469774  "]},"execution_count":168,"metadata":{},"output_type":"execute_result"}],"source":["path  = \"/content/drive/My Drive/signate/SMBC Group GREEN×DATA Challenge 2024/\"\n","# 予測モデルを訓練するためのデータセット\n","train_df = pd.read_csv(path+'train.csv', index_col=0)\n","\n","# 予測モデルに推論（予測)させるデータセット\n","test_df = pd.read_csv(path+'test.csv', index_col=0)\n","train_df.head(5)\n"]},{"cell_type":"code","execution_count":169,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":877},"executionInfo":{"elapsed":70,"status":"ok","timestamp":1731573842149,"user":{"displayName":"ねこ","userId":"00794682924380388788"},"user_tz":-540},"id":"N5oKfuG2Wgg_","outputId":"cc8fb59d-8dfb-425c-973e-7b09cd4281d3"},"outputs":[{"data":{"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"train_df"},"text/html":["\n","  \u003cdiv id=\"df-2c3345ce-5710-4630-96c4-60bf81b659a0\" class=\"colab-df-container\"\u003e\n","    \u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eFacilityName\u003c/th\u003e\n","      \u003cth\u003eLatitude\u003c/th\u003e\n","      \u003cth\u003eLongitude\u003c/th\u003e\n","      \u003cth\u003eLocationAddress\u003c/th\u003e\n","      \u003cth\u003eCity\u003c/th\u003e\n","      \u003cth\u003eState\u003c/th\u003e\n","      \u003cth\u003eZIP\u003c/th\u003e\n","      \u003cth\u003eCounty\u003c/th\u003e\n","      \u003cth\u003eFIPScode\u003c/th\u003e\n","      \u003cth\u003ePrimaryNAICS\u003c/th\u003e\n","      \u003cth\u003eSecondPrimaryNAICS\u003c/th\u003e\n","      \u003cth\u003eIndustryType\u003c/th\u003e\n","      \u003cth\u003eTRI_Air_Emissions_10_in_lbs\u003c/th\u003e\n","      \u003cth\u003eTRI_Air_Emissions_11_in_lbs\u003c/th\u003e\n","      \u003cth\u003eTRI_Air_Emissions_12_in_lbs\u003c/th\u003e\n","      \u003cth\u003eTRI_Air_Emissions_13_in_lbs\u003c/th\u003e\n","      \u003cth\u003eGHG_Direct_Emissions_10_in_metric_tons\u003c/th\u003e\n","      \u003cth\u003eGHG_Direct_Emissions_11_in_metric_tons\u003c/th\u003e\n","      \u003cth\u003eGHG_Direct_Emissions_12_in_metric_tons\u003c/th\u003e\n","      \u003cth\u003eGHG_Direct_Emissions_13_in_metric_tons\u003c/th\u003e\n","      \u003cth\u003eGHG_Direct_Emissions_14_in_metric_tons\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e0\u003c/th\u003e\n","      \u003ctd\u003eVISCOFAN USA INC\u003c/td\u003e\n","      \u003ctd\u003e40.141389\u003c/td\u003e\n","      \u003ctd\u003e-87.581111\u003c/td\u003e\n","      \u003ctd\u003e915 N MICHIGAN AVE\u003c/td\u003e\n","      \u003ctd\u003eDANVILLE\u003c/td\u003e\n","      \u003ctd\u003eIL\u003c/td\u003e\n","      \u003ctd\u003e61832\u003c/td\u003e\n","      \u003ctd\u003eVERMILION\u003c/td\u003e\n","      \u003ctd\u003e17183.0\u003c/td\u003e\n","      \u003ctd\u003e326121\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eOther\u003c/td\u003e\n","      \u003ctd\u003e31566.709644\u003c/td\u003e\n","      \u003ctd\u003e26644.986107\u003c/td\u003e\n","      \u003ctd\u003e23410.379903\u003c/td\u003e\n","      \u003ctd\u003e31809.857564\u003c/td\u003e\n","      \u003ctd\u003e64816.958901\u003c/td\u003e\n","      \u003ctd\u003e36588.744606\u003c/td\u003e\n","      \u003ctd\u003e3.790794e+04\u003c/td\u003e\n","      \u003ctd\u003e45598.125851\u003c/td\u003e\n","      \u003ctd\u003e5.297314e+04\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e1\u003c/th\u003e\n","      \u003ctd\u003eCORNWELL STATION - DOMINION TRANSMISSION, INC\u003c/td\u003e\n","      \u003ctd\u003e38.475305\u003c/td\u003e\n","      \u003ctd\u003e-81.278957\u003c/td\u003e\n","      \u003ctd\u003e200 RIVER HAVEN ROAD\u003c/td\u003e\n","      \u003ctd\u003eCLENDENIN\u003c/td\u003e\n","      \u003ctd\u003eWV\u003c/td\u003e\n","      \u003ctd\u003e25045-9304\u003c/td\u003e\n","      \u003ctd\u003eKANAWHA\u003c/td\u003e\n","      \u003ctd\u003e54039.0\u003c/td\u003e\n","      \u003ctd\u003e486210\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003ePetroleum and Natural Gas Systems\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e55507.543666\u003c/td\u003e\n","      \u003ctd\u003e72387.334115\u003c/td\u003e\n","      \u003ctd\u003e5.822520e+04\u003c/td\u003e\n","      \u003ctd\u003e76376.547318\u003c/td\u003e\n","      \u003ctd\u003e5.591007e+04\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e2\u003c/th\u003e\n","      \u003ctd\u003eWEST UNION COMPRESSOR STATION\u003c/td\u003e\n","      \u003ctd\u003e39.299820\u003c/td\u003e\n","      \u003ctd\u003e-80.857170\u003c/td\u003e\n","      \u003ctd\u003e3041 LONG RUN RD.\u003c/td\u003e\n","      \u003ctd\u003eGREENWOOD\u003c/td\u003e\n","      \u003ctd\u003eWV\u003c/td\u003e\n","      \u003ctd\u003e26415\u003c/td\u003e\n","      \u003ctd\u003eRITCHIE\u003c/td\u003e\n","      \u003ctd\u003e54085.0\u003c/td\u003e\n","      \u003ctd\u003e211112\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003ePetroleum and Natural Gas Systems\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e5.567954e+04\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e3\u003c/th\u003e\n","      \u003ctd\u003eDOUBLE \"C\" LIMITED\u003c/td\u003e\n","      \u003ctd\u003e35.490363\u003c/td\u003e\n","      \u003ctd\u003e-119.042957\u003c/td\u003e\n","      \u003ctd\u003e10245 OILFIELD ROAD\u003c/td\u003e\n","      \u003ctd\u003eBAKERSFIELD\u003c/td\u003e\n","      \u003ctd\u003eCA\u003c/td\u003e\n","      \u003ctd\u003e93308\u003c/td\u003e\n","      \u003ctd\u003eKERN\u003c/td\u003e\n","      \u003ctd\u003e6029.0\u003c/td\u003e\n","      \u003ctd\u003e221112\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003ePower Plants\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e54811.222708\u003c/td\u003e\n","      \u003ctd\u003e69339.923002\u003c/td\u003e\n","      \u003ctd\u003e6.364734e+04\u003c/td\u003e\n","      \u003ctd\u003e53799.011225\u003c/td\u003e\n","      \u003ctd\u003e6.141190e+04\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4\u003c/th\u003e\n","      \u003ctd\u003eLAKESHORE PLANT\u003c/td\u003e\n","      \u003ctd\u003e41.532802\u003c/td\u003e\n","      \u003ctd\u003e-81.636448\u003c/td\u003e\n","      \u003ctd\u003e6800 S MARGINAL RD\u003c/td\u003e\n","      \u003ctd\u003eCLEVELAND\u003c/td\u003e\n","      \u003ctd\u003eOH\u003c/td\u003e\n","      \u003ctd\u003e441031047\u003c/td\u003e\n","      \u003ctd\u003eCUYAHOGA\u003c/td\u003e\n","      \u003ctd\u003e39035.0\u003c/td\u003e\n","      \u003ctd\u003e221112\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003ePower Plants\u003c/td\u003e\n","      \u003ctd\u003e29553.796627\u003c/td\u003e\n","      \u003ctd\u003e28337.832145\u003c/td\u003e\n","      \u003ctd\u003e30840.825454\u003c/td\u003e\n","      \u003ctd\u003e25153.901905\u003c/td\u003e\n","      \u003ctd\u003e81812.306362\u003c/td\u003e\n","      \u003ctd\u003e53823.561587\u003c/td\u003e\n","      \u003ctd\u003e7.739116e+04\u003c/td\u003e\n","      \u003ctd\u003e17662.966241\u003c/td\u003e\n","      \u003ctd\u003e4.310047e+04\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e...\u003c/th\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4650\u003c/th\u003e\n","      \u003ctd\u003eMIDLOTHIAN COMPRESSOR STATION\u003c/td\u003e\n","      \u003ctd\u003e32.523334\u003c/td\u003e\n","      \u003ctd\u003e-97.102556\u003c/td\u003e\n","      \u003ctd\u003e2624 CHAMBERS ST.\u003c/td\u003e\n","      \u003ctd\u003eVENUS\u003c/td\u003e\n","      \u003ctd\u003eTX\u003c/td\u003e\n","      \u003ctd\u003e76084\u003c/td\u003e\n","      \u003ctd\u003eJOHNSON\u003c/td\u003e\n","      \u003ctd\u003e48251.0\u003c/td\u003e\n","      \u003ctd\u003e211111\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003ePetroleum and Natural Gas Systems\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e54978.841280\u003c/td\u003e\n","      \u003ctd\u003e56463.765036\u003c/td\u003e\n","      \u003ctd\u003e3.522786e+06\u003c/td\u003e\n","      \u003ctd\u003e76642.640670\u003c/td\u003e\n","      \u003ctd\u003e2.451197e+06\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4651\u003c/th\u003e\n","      \u003ctd\u003ePARADISE COMPRESSOR STATION\u003c/td\u003e\n","      \u003ctd\u003e42.684900\u003c/td\u003e\n","      \u003ctd\u003e-109.780000\u003c/td\u003e\n","      \u003ctd\u003eSECTION 2, T31N, R109W\u003c/td\u003e\n","      \u003ctd\u003ePINEDALE\u003c/td\u003e\n","      \u003ctd\u003eWY\u003c/td\u003e\n","      \u003ctd\u003e82941\u003c/td\u003e\n","      \u003ctd\u003eSUBLETTE\u003c/td\u003e\n","      \u003ctd\u003e56035.0\u003c/td\u003e\n","      \u003ctd\u003e211111\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003ePetroleum and Natural Gas Systems\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e208375.435367\u003c/td\u003e\n","      \u003ctd\u003e57066.624445\u003c/td\u003e\n","      \u003ctd\u003e4.858030e+04\u003c/td\u003e\n","      \u003ctd\u003e26892.366779\u003c/td\u003e\n","      \u003ctd\u003e3.573974e+04\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4652\u003c/th\u003e\n","      \u003ctd\u003eUNIV OF OK HEALTH S/OKC CAMPUS SVCS\u003c/td\u003e\n","      \u003ctd\u003e35.484260\u003c/td\u003e\n","      \u003ctd\u003e-97.498570\u003c/td\u003e\n","      \u003ctd\u003e800 NE 15TH ST\u003c/td\u003e\n","      \u003ctd\u003eOKLAHOMA CITY\u003c/td\u003e\n","      \u003ctd\u003eOK\u003c/td\u003e\n","      \u003ctd\u003e73104\u003c/td\u003e\n","      \u003ctd\u003eOKLAHOMA\u003c/td\u003e\n","      \u003ctd\u003e40109.0\u003c/td\u003e\n","      \u003ctd\u003e611310\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eOther\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e563756.090695\u003c/td\u003e\n","      \u003ctd\u003e598881.479485\u003c/td\u003e\n","      \u003ctd\u003e1.665103e+06\u003c/td\u003e\n","      \u003ctd\u003e543206.073134\u003c/td\u003e\n","      \u003ctd\u003e9.783592e+05\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4653\u003c/th\u003e\n","      \u003ctd\u003eHARFORD CO. RESOURCE RECOVERY FACILITY\u003c/td\u003e\n","      \u003ctd\u003e39.404310\u003c/td\u003e\n","      \u003ctd\u003e-76.319820\u003c/td\u003e\n","      \u003ctd\u003e1 MAGNOLIA ROAD\u003c/td\u003e\n","      \u003ctd\u003eJOPPA\u003c/td\u003e\n","      \u003ctd\u003eMD\u003c/td\u003e\n","      \u003ctd\u003e21085-4800\u003c/td\u003e\n","      \u003ctd\u003eHARFORD\u003c/td\u003e\n","      \u003ctd\u003e24025.0\u003c/td\u003e\n","      \u003ctd\u003e562213\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eWaste\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e67451.225733\u003c/td\u003e\n","      \u003ctd\u003e27397.929966\u003c/td\u003e\n","      \u003ctd\u003e3.922795e+04\u003c/td\u003e\n","      \u003ctd\u003e46634.777768\u003c/td\u003e\n","      \u003ctd\u003e2.723434e+04\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4654\u003c/th\u003e\n","      \u003ctd\u003eDCNR 595 COMPRESSOR STATION\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e1253 OLD ARNOT ROAD\u003c/td\u003e\n","      \u003ctd\u003eARNOT\u003c/td\u003e\n","      \u003ctd\u003ePA\u003c/td\u003e\n","      \u003ctd\u003e16911\u003c/td\u003e\n","      \u003ctd\u003eTIOGA\u003c/td\u003e\n","      \u003ctd\u003e42117.0\u003c/td\u003e\n","      \u003ctd\u003e211111\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003ePetroleum and Natural Gas Systems\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e1.948221e+05\u003c/td\u003e\n","    \u003c/tr\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003cp\u003e4655 rows × 21 columns\u003c/p\u003e\n","\u003c/div\u003e\n","    \u003cdiv class=\"colab-df-buttons\"\u003e\n","\n","  \u003cdiv class=\"colab-df-container\"\u003e\n","    \u003cbutton class=\"colab-df-convert\" onclick=\"convertToInteractive('df-2c3345ce-5710-4630-96c4-60bf81b659a0')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\"\u003e\n","\n","  \u003csvg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\"\u003e\n","    \u003cpath d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/\u003e\n","  \u003c/svg\u003e\n","    \u003c/button\u003e\n","\n","  \u003cstyle\u003e\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  \u003c/style\u003e\n","\n","    \u003cscript\u003e\n","      const buttonEl =\n","        document.querySelector('#df-2c3345ce-5710-4630-96c4-60bf81b659a0 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-2c3345ce-5710-4630-96c4-60bf81b659a0');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '\u003ca target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb\u003edata table notebook\u003c/a\u003e'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    \u003c/script\u003e\n","  \u003c/div\u003e\n","\n","\n","\u003cdiv id=\"df-5b78d2b2-ca1b-44ce-8bc8-e4d93e3bce4b\"\u003e\n","  \u003cbutton class=\"colab-df-quickchart\" onclick=\"quickchart('df-5b78d2b2-ca1b-44ce-8bc8-e4d93e3bce4b')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\"\u003e\n","\n","\u003csvg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\"\u003e\n","    \u003cg\u003e\n","        \u003cpath d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/\u003e\n","    \u003c/g\u003e\n","\u003c/svg\u003e\n","  \u003c/button\u003e\n","\n","\u003cstyle\u003e\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","\u003c/style\u003e\n","\n","  \u003cscript\u003e\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() =\u003e {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-5b78d2b2-ca1b-44ce-8bc8-e4d93e3bce4b button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  \u003c/script\u003e\n","\u003c/div\u003e\n","\n","  \u003cdiv id=\"id_71acd59e-2c9d-4da9-b27d-a61b250e5f01\"\u003e\n","    \u003cstyle\u003e\n","      .colab-df-generate {\n","        background-color: #E8F0FE;\n","        border: none;\n","        border-radius: 50%;\n","        cursor: pointer;\n","        display: none;\n","        fill: #1967D2;\n","        height: 32px;\n","        padding: 0 0 0 0;\n","        width: 32px;\n","      }\n","\n","      .colab-df-generate:hover {\n","        background-color: #E2EBFA;\n","        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","        fill: #174EA6;\n","      }\n","\n","      [theme=dark] .colab-df-generate {\n","        background-color: #3B4455;\n","        fill: #D2E3FC;\n","      }\n","\n","      [theme=dark] .colab-df-generate:hover {\n","        background-color: #434B5C;\n","        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","        fill: #FFFFFF;\n","      }\n","    \u003c/style\u003e\n","    \u003cbutton class=\"colab-df-generate\" onclick=\"generateWithVariable('train_df')\"\n","            title=\"Generate code using this dataframe.\"\n","            style=\"display:none;\"\u003e\n","\n","  \u003csvg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\"\u003e\n","    \u003cpath d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/\u003e\n","  \u003c/svg\u003e\n","    \u003c/button\u003e\n","    \u003cscript\u003e\n","      (() =\u003e {\n","      const buttonEl =\n","        document.querySelector('#id_71acd59e-2c9d-4da9-b27d-a61b250e5f01 button.colab-df-generate');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      buttonEl.onclick = () =\u003e {\n","        google.colab.notebook.generateWithVariable('train_df');\n","      }\n","      })();\n","    \u003c/script\u003e\n","  \u003c/div\u003e\n","\n","    \u003c/div\u003e\n","  \u003c/div\u003e\n"],"text/plain":["                                       FacilityName   Latitude   Longitude  \\\n","0                                  VISCOFAN USA INC  40.141389  -87.581111   \n","1     CORNWELL STATION - DOMINION TRANSMISSION, INC  38.475305  -81.278957   \n","2                     WEST UNION COMPRESSOR STATION  39.299820  -80.857170   \n","3                                DOUBLE \"C\" LIMITED  35.490363 -119.042957   \n","4                                   LAKESHORE PLANT  41.532802  -81.636448   \n","...                                             ...        ...         ...   \n","4650                  MIDLOTHIAN COMPRESSOR STATION  32.523334  -97.102556   \n","4651                    PARADISE COMPRESSOR STATION  42.684900 -109.780000   \n","4652            UNIV OF OK HEALTH S/OKC CAMPUS SVCS  35.484260  -97.498570   \n","4653         HARFORD CO. RESOURCE RECOVERY FACILITY  39.404310  -76.319820   \n","4654                    DCNR 595 COMPRESSOR STATION        NaN         NaN   \n","\n","             LocationAddress           City State         ZIP     County  \\\n","0         915 N MICHIGAN AVE       DANVILLE    IL       61832  VERMILION   \n","1       200 RIVER HAVEN ROAD      CLENDENIN    WV  25045-9304    KANAWHA   \n","2          3041 LONG RUN RD.      GREENWOOD    WV       26415    RITCHIE   \n","3        10245 OILFIELD ROAD    BAKERSFIELD    CA       93308       KERN   \n","4         6800 S MARGINAL RD      CLEVELAND    OH   441031047   CUYAHOGA   \n","...                      ...            ...   ...         ...        ...   \n","4650       2624 CHAMBERS ST.          VENUS    TX       76084    JOHNSON   \n","4651  SECTION 2, T31N, R109W       PINEDALE    WY       82941   SUBLETTE   \n","4652          800 NE 15TH ST  OKLAHOMA CITY    OK       73104   OKLAHOMA   \n","4653         1 MAGNOLIA ROAD          JOPPA    MD  21085-4800    HARFORD   \n","4654     1253 OLD ARNOT ROAD          ARNOT    PA       16911      TIOGA   \n","\n","      FIPScode  PrimaryNAICS  SecondPrimaryNAICS  \\\n","0      17183.0        326121                 NaN   \n","1      54039.0        486210                 NaN   \n","2      54085.0        211112                 NaN   \n","3       6029.0        221112                 NaN   \n","4      39035.0        221112                 NaN   \n","...        ...           ...                 ...   \n","4650   48251.0        211111                 NaN   \n","4651   56035.0        211111                 NaN   \n","4652   40109.0        611310                 NaN   \n","4653   24025.0        562213                 NaN   \n","4654   42117.0        211111                 NaN   \n","\n","                           IndustryType  TRI_Air_Emissions_10_in_lbs  \\\n","0                                 Other                 31566.709644   \n","1     Petroleum and Natural Gas Systems                          NaN   \n","2     Petroleum and Natural Gas Systems                          NaN   \n","3                          Power Plants                          NaN   \n","4                          Power Plants                 29553.796627   \n","...                                 ...                          ...   \n","4650  Petroleum and Natural Gas Systems                          NaN   \n","4651  Petroleum and Natural Gas Systems                          NaN   \n","4652                              Other                          NaN   \n","4653                              Waste                          NaN   \n","4654  Petroleum and Natural Gas Systems                          NaN   \n","\n","      TRI_Air_Emissions_11_in_lbs  TRI_Air_Emissions_12_in_lbs  \\\n","0                    26644.986107                 23410.379903   \n","1                             NaN                          NaN   \n","2                             NaN                          NaN   \n","3                             NaN                          NaN   \n","4                    28337.832145                 30840.825454   \n","...                           ...                          ...   \n","4650                          NaN                          NaN   \n","4651                          NaN                          NaN   \n","4652                          NaN                          NaN   \n","4653                          NaN                          NaN   \n","4654                          NaN                          NaN   \n","\n","      TRI_Air_Emissions_13_in_lbs  GHG_Direct_Emissions_10_in_metric_tons  \\\n","0                    31809.857564                            64816.958901   \n","1                             NaN                            55507.543666   \n","2                             NaN                                     NaN   \n","3                             NaN                            54811.222708   \n","4                    25153.901905                            81812.306362   \n","...                           ...                                     ...   \n","4650                          NaN                            54978.841280   \n","4651                          NaN                           208375.435367   \n","4652                          NaN                           563756.090695   \n","4653                          NaN                            67451.225733   \n","4654                          NaN                                     NaN   \n","\n","      GHG_Direct_Emissions_11_in_metric_tons  \\\n","0                               36588.744606   \n","1                               72387.334115   \n","2                                        NaN   \n","3                               69339.923002   \n","4                               53823.561587   \n","...                                      ...   \n","4650                            56463.765036   \n","4651                            57066.624445   \n","4652                           598881.479485   \n","4653                            27397.929966   \n","4654                                     NaN   \n","\n","      GHG_Direct_Emissions_12_in_metric_tons  \\\n","0                               3.790794e+04   \n","1                               5.822520e+04   \n","2                                        NaN   \n","3                               6.364734e+04   \n","4                               7.739116e+04   \n","...                                      ...   \n","4650                            3.522786e+06   \n","4651                            4.858030e+04   \n","4652                            1.665103e+06   \n","4653                            3.922795e+04   \n","4654                                     NaN   \n","\n","      GHG_Direct_Emissions_13_in_metric_tons  \\\n","0                               45598.125851   \n","1                               76376.547318   \n","2                                        NaN   \n","3                               53799.011225   \n","4                               17662.966241   \n","...                                      ...   \n","4650                            76642.640670   \n","4651                            26892.366779   \n","4652                           543206.073134   \n","4653                            46634.777768   \n","4654                                     NaN   \n","\n","      GHG_Direct_Emissions_14_in_metric_tons  \n","0                               5.297314e+04  \n","1                               5.591007e+04  \n","2                               5.567954e+04  \n","3                               6.141190e+04  \n","4                               4.310047e+04  \n","...                                      ...  \n","4650                            2.451197e+06  \n","4651                            3.573974e+04  \n","4652                            9.783592e+05  \n","4653                            2.723434e+04  \n","4654                            1.948221e+05  \n","\n","[4655 rows x 21 columns]"]},"execution_count":169,"metadata":{},"output_type":"execute_result"}],"source":["# すべての列を表示するように設定\n","pd.set_option('display.max_columns', None)\n","train_df"]},{"cell_type":"code","execution_count":170,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":65,"status":"ok","timestamp":1731573842150,"user":{"displayName":"ねこ","userId":"00794682924380388788"},"user_tz":-540},"id":"6jFlC7ZcOaCu","outputId":"e67d4760-8705-4e47-df37-28297cd56b9c"},"outputs":[{"name":"stdout","output_type":"stream","text":["\u003cclass 'pandas.core.frame.DataFrame'\u003e\n","Index: 4655 entries, 0 to 4654\n","Data columns (total 21 columns):\n"," #   Column                                  Non-Null Count  Dtype  \n","---  ------                                  --------------  -----  \n"," 0   FacilityName                            4655 non-null   object \n"," 1   Latitude                                4553 non-null   float64\n"," 2   Longitude                               4553 non-null   float64\n"," 3   LocationAddress                         4476 non-null   object \n"," 4   City                                    4655 non-null   object \n"," 5   State                                   4655 non-null   object \n"," 6   ZIP                                     4655 non-null   object \n"," 7   County                                  4585 non-null   object \n"," 8   FIPScode                                4582 non-null   float64\n"," 9   PrimaryNAICS                            4655 non-null   int64  \n"," 10  SecondPrimaryNAICS                      379 non-null    float64\n"," 11  IndustryType                            4654 non-null   object \n"," 12  TRI_Air_Emissions_10_in_lbs             1635 non-null   float64\n"," 13  TRI_Air_Emissions_11_in_lbs             1635 non-null   float64\n"," 14  TRI_Air_Emissions_12_in_lbs             1635 non-null   float64\n"," 15  TRI_Air_Emissions_13_in_lbs             1635 non-null   float64\n"," 16  GHG_Direct_Emissions_10_in_metric_tons  3953 non-null   float64\n"," 17  GHG_Direct_Emissions_11_in_metric_tons  4284 non-null   float64\n"," 18  GHG_Direct_Emissions_12_in_metric_tons  4395 non-null   float64\n"," 19  GHG_Direct_Emissions_13_in_metric_tons  4507 non-null   float64\n"," 20  GHG_Direct_Emissions_14_in_metric_tons  4655 non-null   float64\n","dtypes: float64(13), int64(1), object(7)\n","memory usage: 800.1+ KB\n"]}],"source":["train_df.info()"]},{"cell_type":"markdown","metadata":{"id":"hZb4s18YW-SY"},"source":["TRIの欠損地が多すぎてお話にならない。どうしたものか"]},{"cell_type":"code","execution_count":171,"metadata":{"executionInfo":{"elapsed":61,"status":"ok","timestamp":1731573842150,"user":{"displayName":"ねこ","userId":"00794682924380388788"},"user_tz":-540},"id":"k-fHPztgKqG-"},"outputs":[],"source":["\n","# # 特徴量とターゲットの分離\n","# X_train = train_df[[\"Latitude\", \"Longitude\"]]\n","# y_train = train_df[\"GHG_Direct_Emissions_14_in_metric_tons\"]\n","# X_test = test_df[[\"Latitude\", \"Longitude\"]]\n","\n","# # データの前処理（欠損値の処理）\n","# # 欠損値がある場合は適切に補完します（例：中央値で補完）\n","# X_train = X_train.fillna(X_train.median())\n","# X_test = X_test.fillna(X_train.median())  # 訓練データの中央値で補完\n","\n","# # 特徴量のスケーリング（オプション）\n","# scaler = StandardScaler()\n","# X_train_scaled = scaler.fit_transform(X_train)\n","# X_test_scaled = scaler.transform(X_test)\n","\n","# # KNeighborsRegressor のインスタンス作成\n","# knn_regressor = KNeighborsRegressor(\n","#     n_neighbors=5,       # 近傍点の数（適宜調整）\n","#     weights='uniform',   # 重み付け方法（'uniform' または 'distance'）\n","#     algorithm='auto',    # 使用するアルゴリズム（'auto', 'ball_tree', 'kd_tree', 'brute'）\n","#     metric='euclidean'   # 距離の測定方法\n","# )\n","\n","# # モデルの訓練\n","# knn_regressor.fit(X_train_scaled, y_train)\n","\n","# # 訓練データでの予測（オプション、モデルの性能確認用）\n","# train_predictions = knn_regressor.predict(X_train_scaled)\n","# train_mse = mean_squared_error(y_train, train_predictions)\n","# print(f\"Train Mean Squared Error: {train_mse:.2f}\")\n","\n","# # テストデータでの予測\n","# test_predictions = knn_regressor.predict(X_test_scaled)\n","\n","# # 予測結果の保存\n","# key = \"Estimation by location\"\n","# train_df[key] = knn_regressor.predict(X_train_scaled)\n","# test_df[key] = test_predictions\n"]},{"cell_type":"code","execution_count":172,"metadata":{"executionInfo":{"elapsed":53,"status":"ok","timestamp":1731573842150,"user":{"displayName":"ねこ","userId":"00794682924380388788"},"user_tz":-540},"id":"hJBv0scBXLBG"},"outputs":[],"source":["numerical_columns = [\n","                    'TRI_Air_Emissions_10_in_lbs', 'TRI_Air_Emissions_11_in_lbs',\n","                    'TRI_Air_Emissions_12_in_lbs', 'TRI_Air_Emissions_13_in_lbs',\n","                    'GHG_Direct_Emissions_10_in_metric_tons', 'GHG_Direct_Emissions_11_in_metric_tons',\n","                    'GHG_Direct_Emissions_12_in_metric_tons', 'GHG_Direct_Emissions_13_in_metric_tons',\n","                    ]\n","lat_lon_columns   = ['Latitude','Longitude']\n","target_columns    = ['GHG_Direct_Emissions_14_in_metric_tons']\n","categorical_columns = list(set(train_df.columns)-((set(numerical_columns) | set(lat_lon_columns) | set(target_columns))))"]},{"cell_type":"code","execution_count":173,"metadata":{"executionInfo":{"elapsed":52,"status":"ok","timestamp":1731573842150,"user":{"displayName":"ねこ","userId":"00794682924380388788"},"user_tz":-540},"id":"XbJqPe3-XXH3"},"outputs":[],"source":["\n","def overlapping_values(colname,train_df,test_df):\n","    '''\n","        Returns the overlapping values in train data for the values present in test data.\n","    '''\n","    train_unique = set(train_df[colname].unique())\n","    test_unique  = set(test_df[colname].unique())\n","    intersection = test_unique \u0026 train_unique\n","    return len(intersection)/test_df.shape[0]"]},{"cell_type":"code","execution_count":174,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":52,"status":"ok","timestamp":1731573842151,"user":{"displayName":"ねこ","userId":"00794682924380388788"},"user_tz":-540},"id":"Ut5iTlGwXZLc","outputId":"7abf53dd-1632-45a1-8dbd-47004c0756c1"},"outputs":[{"name":"stdout","output_type":"stream","text":["column - ZIP has 21.251993620414673% values in train data\n","column - State has 2.15311004784689% values in train data\n","column - City has 34.05103668261563% values in train data\n","column - FIPScode has 35.24720893141946% values in train data\n","column - IndustryType has 1.5151515151515151% values in train data\n","column - FacilityName has 3.5486443381180224% values in train data\n","column - SecondPrimaryNAICS has 2.0334928229665072% values in train data\n","column - PrimaryNAICS has 6.180223285486443% values in train data\n","column - LocationAddress has 1.036682615629984% values in train data\n","column - County has 28.78787878787879% values in train data\n"]}],"source":["\n","for colname in categorical_columns:\n","    overlap = overlapping_values(colname,train_df,test_df)\n","    print(f'column - {colname} has {overlap*100}% values in train data')"]},{"cell_type":"code","execution_count":175,"metadata":{"executionInfo":{"elapsed":48,"status":"ok","timestamp":1731573842151,"user":{"displayName":"ねこ","userId":"00794682924380388788"},"user_tz":-540},"id":"mUzVwySPXbTJ"},"outputs":[],"source":["def create_features1(df):\n","\n","\n","    # Year-over-year difference\n","    df['TRI_Air_Emissions_YoY_Change_11'] = df['TRI_Air_Emissions_11_in_lbs'] - df['TRI_Air_Emissions_10_in_lbs']\n","    df['TRI_Air_Emissions_YoY_Change_12'] = df['TRI_Air_Emissions_12_in_lbs'] - df['TRI_Air_Emissions_11_in_lbs']\n","    df['TRI_Air_Emissions_YoY_Change_13'] = df['TRI_Air_Emissions_13_in_lbs'] - df['TRI_Air_Emissions_12_in_lbs']\n","\n","    # Year-over-year growth rate\n","    df['TRI_Air_Emissions_Growth_Rate_11'] = (df['TRI_Air_Emissions_11_in_lbs'] - df['TRI_Air_Emissions_10_in_lbs']) / df['TRI_Air_Emissions_10_in_lbs']\n","    df['TRI_Air_Emissions_Growth_Rate_12'] = (df['TRI_Air_Emissions_12_in_lbs'] - df['TRI_Air_Emissions_11_in_lbs']) / df['TRI_Air_Emissions_11_in_lbs']\n","    df['TRI_Air_Emissions_Growth_Rate_13'] = (df['TRI_Air_Emissions_13_in_lbs'] - df['TRI_Air_Emissions_12_in_lbs']) / df['TRI_Air_Emissions_12_in_lbs']\n","\n","    df[\"G12/G10\"] = df[\"GHG_Direct_Emissions_12_in_metric_tons\"] / df[\"GHG_Direct_Emissions_10_in_metric_tons\"]\n","    df[\"G13/G11\"] = df[\"GHG_Direct_Emissions_13_in_metric_tons\"] / df[\"GHG_Direct_Emissions_11_in_metric_tons\"]\n","    return df\n","\n","\n","def create_features2(df):\n","    df['TRI_to_GHG_Ratio_10'] = df['TRI_Air_Emissions_10_in_lbs'] / (df['GHG_Direct_Emissions_10_in_metric_tons'] + 1e-6)  # Avoid division by zero\n","    df['TRI_to_GHG_Ratio_11'] = df['TRI_Air_Emissions_11_in_lbs'] / (df['GHG_Direct_Emissions_11_in_metric_tons'] + 1e-6)\n","    df['TRI_to_GHG_Ratio_12'] = df['TRI_Air_Emissions_12_in_lbs'] / (df['GHG_Direct_Emissions_12_in_metric_tons'] + 1e-6)\n","    df['TRI_to_GHG_Ratio_13'] = df['TRI_Air_Emissions_13_in_lbs'] / (df['GHG_Direct_Emissions_13_in_metric_tons'] + 1e-6)\n","    return df"]},{"cell_type":"code","execution_count":176,"metadata":{"executionInfo":{"elapsed":47,"status":"ok","timestamp":1731573842151,"user":{"displayName":"ねこ","userId":"00794682924380388788"},"user_tz":-540},"id":"QuOR7Ll_XdNh"},"outputs":[],"source":["train_df      = create_features1(train_df)\n","test_df       = create_features1(test_df)\n","new_features1 = ['TRI_Air_Emissions_YoY_Change_11','TRI_Air_Emissions_YoY_Change_12','TRI_Air_Emissions_YoY_Change_13',\n","                     'TRI_Air_Emissions_Growth_Rate_11','TRI_Air_Emissions_Growth_Rate_12','TRI_Air_Emissions_Growth_Rate_13',\n","                 \"G12/G10\", \"G13/G11\"]\n","\n","\n","train_df      = create_features2(train_df)\n","test_df       = create_features2(test_df)\n","new_features2 = ['TRI_to_GHG_Ratio_10','TRI_to_GHG_Ratio_11','TRI_to_GHG_Ratio_12','TRI_to_GHG_Ratio_13']"]},{"cell_type":"code","execution_count":177,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":877},"executionInfo":{"elapsed":47,"status":"ok","timestamp":1731573842151,"user":{"displayName":"ねこ","userId":"00794682924380388788"},"user_tz":-540},"id":"Umd7tQ07Regc","outputId":"0d828e1d-f623-43d9-be8e-b409d3032d24"},"outputs":[{"data":{"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"train_df"},"text/html":["\n","  \u003cdiv id=\"df-5e9ebe87-69d1-48cd-b32d-09a78bb8f8c2\" class=\"colab-df-container\"\u003e\n","    \u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eFacilityName\u003c/th\u003e\n","      \u003cth\u003eLatitude\u003c/th\u003e\n","      \u003cth\u003eLongitude\u003c/th\u003e\n","      \u003cth\u003eLocationAddress\u003c/th\u003e\n","      \u003cth\u003eCity\u003c/th\u003e\n","      \u003cth\u003eState\u003c/th\u003e\n","      \u003cth\u003eZIP\u003c/th\u003e\n","      \u003cth\u003eCounty\u003c/th\u003e\n","      \u003cth\u003eFIPScode\u003c/th\u003e\n","      \u003cth\u003ePrimaryNAICS\u003c/th\u003e\n","      \u003cth\u003eSecondPrimaryNAICS\u003c/th\u003e\n","      \u003cth\u003eIndustryType\u003c/th\u003e\n","      \u003cth\u003eTRI_Air_Emissions_10_in_lbs\u003c/th\u003e\n","      \u003cth\u003eTRI_Air_Emissions_11_in_lbs\u003c/th\u003e\n","      \u003cth\u003eTRI_Air_Emissions_12_in_lbs\u003c/th\u003e\n","      \u003cth\u003eTRI_Air_Emissions_13_in_lbs\u003c/th\u003e\n","      \u003cth\u003eGHG_Direct_Emissions_10_in_metric_tons\u003c/th\u003e\n","      \u003cth\u003eGHG_Direct_Emissions_11_in_metric_tons\u003c/th\u003e\n","      \u003cth\u003eGHG_Direct_Emissions_12_in_metric_tons\u003c/th\u003e\n","      \u003cth\u003eGHG_Direct_Emissions_13_in_metric_tons\u003c/th\u003e\n","      \u003cth\u003eGHG_Direct_Emissions_14_in_metric_tons\u003c/th\u003e\n","      \u003cth\u003eTRI_Air_Emissions_YoY_Change_11\u003c/th\u003e\n","      \u003cth\u003eTRI_Air_Emissions_YoY_Change_12\u003c/th\u003e\n","      \u003cth\u003eTRI_Air_Emissions_YoY_Change_13\u003c/th\u003e\n","      \u003cth\u003eTRI_Air_Emissions_Growth_Rate_11\u003c/th\u003e\n","      \u003cth\u003eTRI_Air_Emissions_Growth_Rate_12\u003c/th\u003e\n","      \u003cth\u003eTRI_Air_Emissions_Growth_Rate_13\u003c/th\u003e\n","      \u003cth\u003eG12/G10\u003c/th\u003e\n","      \u003cth\u003eG13/G11\u003c/th\u003e\n","      \u003cth\u003eTRI_to_GHG_Ratio_10\u003c/th\u003e\n","      \u003cth\u003eTRI_to_GHG_Ratio_11\u003c/th\u003e\n","      \u003cth\u003eTRI_to_GHG_Ratio_12\u003c/th\u003e\n","      \u003cth\u003eTRI_to_GHG_Ratio_13\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e0\u003c/th\u003e\n","      \u003ctd\u003eVISCOFAN USA INC\u003c/td\u003e\n","      \u003ctd\u003e40.141389\u003c/td\u003e\n","      \u003ctd\u003e-87.581111\u003c/td\u003e\n","      \u003ctd\u003e915 N MICHIGAN AVE\u003c/td\u003e\n","      \u003ctd\u003eDANVILLE\u003c/td\u003e\n","      \u003ctd\u003eIL\u003c/td\u003e\n","      \u003ctd\u003e61832\u003c/td\u003e\n","      \u003ctd\u003eVERMILION\u003c/td\u003e\n","      \u003ctd\u003e17183.0\u003c/td\u003e\n","      \u003ctd\u003e326121\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eOther\u003c/td\u003e\n","      \u003ctd\u003e31566.709644\u003c/td\u003e\n","      \u003ctd\u003e26644.986107\u003c/td\u003e\n","      \u003ctd\u003e23410.379903\u003c/td\u003e\n","      \u003ctd\u003e31809.857564\u003c/td\u003e\n","      \u003ctd\u003e64816.958901\u003c/td\u003e\n","      \u003ctd\u003e36588.744606\u003c/td\u003e\n","      \u003ctd\u003e3.790794e+04\u003c/td\u003e\n","      \u003ctd\u003e45598.125851\u003c/td\u003e\n","      \u003ctd\u003e5.297314e+04\u003c/td\u003e\n","      \u003ctd\u003e-4921.723537\u003c/td\u003e\n","      \u003ctd\u003e-3234.606204\u003c/td\u003e\n","      \u003ctd\u003e8399.477661\u003c/td\u003e\n","      \u003ctd\u003e-0.155915\u003c/td\u003e\n","      \u003ctd\u003e-0.121396\u003c/td\u003e\n","      \u003ctd\u003e0.358793\u003c/td\u003e\n","      \u003ctd\u003e0.584846\u003c/td\u003e\n","      \u003ctd\u003e1.246234\u003c/td\u003e\n","      \u003ctd\u003e0.487013\u003c/td\u003e\n","      \u003ctd\u003e0.728229\u003c/td\u003e\n","      \u003ctd\u003e0.617559\u003c/td\u003e\n","      \u003ctd\u003e0.697613\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e1\u003c/th\u003e\n","      \u003ctd\u003eCORNWELL STATION - DOMINION TRANSMISSION, INC\u003c/td\u003e\n","      \u003ctd\u003e38.475305\u003c/td\u003e\n","      \u003ctd\u003e-81.278957\u003c/td\u003e\n","      \u003ctd\u003e200 RIVER HAVEN ROAD\u003c/td\u003e\n","      \u003ctd\u003eCLENDENIN\u003c/td\u003e\n","      \u003ctd\u003eWV\u003c/td\u003e\n","      \u003ctd\u003e25045-9304\u003c/td\u003e\n","      \u003ctd\u003eKANAWHA\u003c/td\u003e\n","      \u003ctd\u003e54039.0\u003c/td\u003e\n","      \u003ctd\u003e486210\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003ePetroleum and Natural Gas Systems\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e55507.543666\u003c/td\u003e\n","      \u003ctd\u003e72387.334115\u003c/td\u003e\n","      \u003ctd\u003e5.822520e+04\u003c/td\u003e\n","      \u003ctd\u003e76376.547318\u003c/td\u003e\n","      \u003ctd\u003e5.591007e+04\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e1.048960\u003c/td\u003e\n","      \u003ctd\u003e1.055109\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e2\u003c/th\u003e\n","      \u003ctd\u003eWEST UNION COMPRESSOR STATION\u003c/td\u003e\n","      \u003ctd\u003e39.299820\u003c/td\u003e\n","      \u003ctd\u003e-80.857170\u003c/td\u003e\n","      \u003ctd\u003e3041 LONG RUN RD.\u003c/td\u003e\n","      \u003ctd\u003eGREENWOOD\u003c/td\u003e\n","      \u003ctd\u003eWV\u003c/td\u003e\n","      \u003ctd\u003e26415\u003c/td\u003e\n","      \u003ctd\u003eRITCHIE\u003c/td\u003e\n","      \u003ctd\u003e54085.0\u003c/td\u003e\n","      \u003ctd\u003e211112\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003ePetroleum and Natural Gas Systems\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e5.567954e+04\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e3\u003c/th\u003e\n","      \u003ctd\u003eDOUBLE \"C\" LIMITED\u003c/td\u003e\n","      \u003ctd\u003e35.490363\u003c/td\u003e\n","      \u003ctd\u003e-119.042957\u003c/td\u003e\n","      \u003ctd\u003e10245 OILFIELD ROAD\u003c/td\u003e\n","      \u003ctd\u003eBAKERSFIELD\u003c/td\u003e\n","      \u003ctd\u003eCA\u003c/td\u003e\n","      \u003ctd\u003e93308\u003c/td\u003e\n","      \u003ctd\u003eKERN\u003c/td\u003e\n","      \u003ctd\u003e6029.0\u003c/td\u003e\n","      \u003ctd\u003e221112\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003ePower Plants\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e54811.222708\u003c/td\u003e\n","      \u003ctd\u003e69339.923002\u003c/td\u003e\n","      \u003ctd\u003e6.364734e+04\u003c/td\u003e\n","      \u003ctd\u003e53799.011225\u003c/td\u003e\n","      \u003ctd\u003e6.141190e+04\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e1.161210\u003c/td\u003e\n","      \u003ctd\u003e0.775874\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4\u003c/th\u003e\n","      \u003ctd\u003eLAKESHORE PLANT\u003c/td\u003e\n","      \u003ctd\u003e41.532802\u003c/td\u003e\n","      \u003ctd\u003e-81.636448\u003c/td\u003e\n","      \u003ctd\u003e6800 S MARGINAL RD\u003c/td\u003e\n","      \u003ctd\u003eCLEVELAND\u003c/td\u003e\n","      \u003ctd\u003eOH\u003c/td\u003e\n","      \u003ctd\u003e441031047\u003c/td\u003e\n","      \u003ctd\u003eCUYAHOGA\u003c/td\u003e\n","      \u003ctd\u003e39035.0\u003c/td\u003e\n","      \u003ctd\u003e221112\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003ePower Plants\u003c/td\u003e\n","      \u003ctd\u003e29553.796627\u003c/td\u003e\n","      \u003ctd\u003e28337.832145\u003c/td\u003e\n","      \u003ctd\u003e30840.825454\u003c/td\u003e\n","      \u003ctd\u003e25153.901905\u003c/td\u003e\n","      \u003ctd\u003e81812.306362\u003c/td\u003e\n","      \u003ctd\u003e53823.561587\u003c/td\u003e\n","      \u003ctd\u003e7.739116e+04\u003c/td\u003e\n","      \u003ctd\u003e17662.966241\u003c/td\u003e\n","      \u003ctd\u003e4.310047e+04\u003c/td\u003e\n","      \u003ctd\u003e-1215.964481\u003c/td\u003e\n","      \u003ctd\u003e2502.993309\u003c/td\u003e\n","      \u003ctd\u003e-5686.923550\u003c/td\u003e\n","      \u003ctd\u003e-0.041144\u003c/td\u003e\n","      \u003ctd\u003e0.088327\u003c/td\u003e\n","      \u003ctd\u003e-0.184396\u003c/td\u003e\n","      \u003ctd\u003e0.945960\u003c/td\u003e\n","      \u003ctd\u003e0.328164\u003c/td\u003e\n","      \u003ctd\u003e0.361239\u003c/td\u003e\n","      \u003ctd\u003e0.526495\u003c/td\u003e\n","      \u003ctd\u003e0.398506\u003c/td\u003e\n","      \u003ctd\u003e1.424104\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e...\u003c/th\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4650\u003c/th\u003e\n","      \u003ctd\u003eMIDLOTHIAN COMPRESSOR STATION\u003c/td\u003e\n","      \u003ctd\u003e32.523334\u003c/td\u003e\n","      \u003ctd\u003e-97.102556\u003c/td\u003e\n","      \u003ctd\u003e2624 CHAMBERS ST.\u003c/td\u003e\n","      \u003ctd\u003eVENUS\u003c/td\u003e\n","      \u003ctd\u003eTX\u003c/td\u003e\n","      \u003ctd\u003e76084\u003c/td\u003e\n","      \u003ctd\u003eJOHNSON\u003c/td\u003e\n","      \u003ctd\u003e48251.0\u003c/td\u003e\n","      \u003ctd\u003e211111\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003ePetroleum and Natural Gas Systems\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e54978.841280\u003c/td\u003e\n","      \u003ctd\u003e56463.765036\u003c/td\u003e\n","      \u003ctd\u003e3.522786e+06\u003c/td\u003e\n","      \u003ctd\u003e76642.640670\u003c/td\u003e\n","      \u003ctd\u003e2.451197e+06\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e64.075298\u003c/td\u003e\n","      \u003ctd\u003e1.357377\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4651\u003c/th\u003e\n","      \u003ctd\u003ePARADISE COMPRESSOR STATION\u003c/td\u003e\n","      \u003ctd\u003e42.684900\u003c/td\u003e\n","      \u003ctd\u003e-109.780000\u003c/td\u003e\n","      \u003ctd\u003eSECTION 2, T31N, R109W\u003c/td\u003e\n","      \u003ctd\u003ePINEDALE\u003c/td\u003e\n","      \u003ctd\u003eWY\u003c/td\u003e\n","      \u003ctd\u003e82941\u003c/td\u003e\n","      \u003ctd\u003eSUBLETTE\u003c/td\u003e\n","      \u003ctd\u003e56035.0\u003c/td\u003e\n","      \u003ctd\u003e211111\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003ePetroleum and Natural Gas Systems\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e208375.435367\u003c/td\u003e\n","      \u003ctd\u003e57066.624445\u003c/td\u003e\n","      \u003ctd\u003e4.858030e+04\u003c/td\u003e\n","      \u003ctd\u003e26892.366779\u003c/td\u003e\n","      \u003ctd\u003e3.573974e+04\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e0.233138\u003c/td\u003e\n","      \u003ctd\u003e0.471245\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4652\u003c/th\u003e\n","      \u003ctd\u003eUNIV OF OK HEALTH S/OKC CAMPUS SVCS\u003c/td\u003e\n","      \u003ctd\u003e35.484260\u003c/td\u003e\n","      \u003ctd\u003e-97.498570\u003c/td\u003e\n","      \u003ctd\u003e800 NE 15TH ST\u003c/td\u003e\n","      \u003ctd\u003eOKLAHOMA CITY\u003c/td\u003e\n","      \u003ctd\u003eOK\u003c/td\u003e\n","      \u003ctd\u003e73104\u003c/td\u003e\n","      \u003ctd\u003eOKLAHOMA\u003c/td\u003e\n","      \u003ctd\u003e40109.0\u003c/td\u003e\n","      \u003ctd\u003e611310\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eOther\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e563756.090695\u003c/td\u003e\n","      \u003ctd\u003e598881.479485\u003c/td\u003e\n","      \u003ctd\u003e1.665103e+06\u003c/td\u003e\n","      \u003ctd\u003e543206.073134\u003c/td\u003e\n","      \u003ctd\u003e9.783592e+05\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e2.953588\u003c/td\u003e\n","      \u003ctd\u003e0.907034\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4653\u003c/th\u003e\n","      \u003ctd\u003eHARFORD CO. RESOURCE RECOVERY FACILITY\u003c/td\u003e\n","      \u003ctd\u003e39.404310\u003c/td\u003e\n","      \u003ctd\u003e-76.319820\u003c/td\u003e\n","      \u003ctd\u003e1 MAGNOLIA ROAD\u003c/td\u003e\n","      \u003ctd\u003eJOPPA\u003c/td\u003e\n","      \u003ctd\u003eMD\u003c/td\u003e\n","      \u003ctd\u003e21085-4800\u003c/td\u003e\n","      \u003ctd\u003eHARFORD\u003c/td\u003e\n","      \u003ctd\u003e24025.0\u003c/td\u003e\n","      \u003ctd\u003e562213\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eWaste\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e67451.225733\u003c/td\u003e\n","      \u003ctd\u003e27397.929966\u003c/td\u003e\n","      \u003ctd\u003e3.922795e+04\u003c/td\u003e\n","      \u003ctd\u003e46634.777768\u003c/td\u003e\n","      \u003ctd\u003e2.723434e+04\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e0.581575\u003c/td\u003e\n","      \u003ctd\u003e1.702128\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4654\u003c/th\u003e\n","      \u003ctd\u003eDCNR 595 COMPRESSOR STATION\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e1253 OLD ARNOT ROAD\u003c/td\u003e\n","      \u003ctd\u003eARNOT\u003c/td\u003e\n","      \u003ctd\u003ePA\u003c/td\u003e\n","      \u003ctd\u003e16911\u003c/td\u003e\n","      \u003ctd\u003eTIOGA\u003c/td\u003e\n","      \u003ctd\u003e42117.0\u003c/td\u003e\n","      \u003ctd\u003e211111\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003ePetroleum and Natural Gas Systems\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003e1.948221e+05\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","      \u003ctd\u003eNaN\u003c/td\u003e\n","    \u003c/tr\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003cp\u003e4655 rows × 33 columns\u003c/p\u003e\n","\u003c/div\u003e\n","    \u003cdiv class=\"colab-df-buttons\"\u003e\n","\n","  \u003cdiv class=\"colab-df-container\"\u003e\n","    \u003cbutton class=\"colab-df-convert\" onclick=\"convertToInteractive('df-5e9ebe87-69d1-48cd-b32d-09a78bb8f8c2')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\"\u003e\n","\n","  \u003csvg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\"\u003e\n","    \u003cpath d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/\u003e\n","  \u003c/svg\u003e\n","    \u003c/button\u003e\n","\n","  \u003cstyle\u003e\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  \u003c/style\u003e\n","\n","    \u003cscript\u003e\n","      const buttonEl =\n","        document.querySelector('#df-5e9ebe87-69d1-48cd-b32d-09a78bb8f8c2 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-5e9ebe87-69d1-48cd-b32d-09a78bb8f8c2');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '\u003ca target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb\u003edata table notebook\u003c/a\u003e'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    \u003c/script\u003e\n","  \u003c/div\u003e\n","\n","\n","\u003cdiv id=\"df-8d03ec95-d743-42fe-98f6-eadc7643ce32\"\u003e\n","  \u003cbutton class=\"colab-df-quickchart\" onclick=\"quickchart('df-8d03ec95-d743-42fe-98f6-eadc7643ce32')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\"\u003e\n","\n","\u003csvg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\"\u003e\n","    \u003cg\u003e\n","        \u003cpath d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/\u003e\n","    \u003c/g\u003e\n","\u003c/svg\u003e\n","  \u003c/button\u003e\n","\n","\u003cstyle\u003e\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","\u003c/style\u003e\n","\n","  \u003cscript\u003e\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() =\u003e {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-8d03ec95-d743-42fe-98f6-eadc7643ce32 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  \u003c/script\u003e\n","\u003c/div\u003e\n","\n","  \u003cdiv id=\"id_4bb25363-f5d3-4283-9b9b-9fd88b15bd78\"\u003e\n","    \u003cstyle\u003e\n","      .colab-df-generate {\n","        background-color: #E8F0FE;\n","        border: none;\n","        border-radius: 50%;\n","        cursor: pointer;\n","        display: none;\n","        fill: #1967D2;\n","        height: 32px;\n","        padding: 0 0 0 0;\n","        width: 32px;\n","      }\n","\n","      .colab-df-generate:hover {\n","        background-color: #E2EBFA;\n","        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","        fill: #174EA6;\n","      }\n","\n","      [theme=dark] .colab-df-generate {\n","        background-color: #3B4455;\n","        fill: #D2E3FC;\n","      }\n","\n","      [theme=dark] .colab-df-generate:hover {\n","        background-color: #434B5C;\n","        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","        fill: #FFFFFF;\n","      }\n","    \u003c/style\u003e\n","    \u003cbutton class=\"colab-df-generate\" onclick=\"generateWithVariable('train_df')\"\n","            title=\"Generate code using this dataframe.\"\n","            style=\"display:none;\"\u003e\n","\n","  \u003csvg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\"\u003e\n","    \u003cpath d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/\u003e\n","  \u003c/svg\u003e\n","    \u003c/button\u003e\n","    \u003cscript\u003e\n","      (() =\u003e {\n","      const buttonEl =\n","        document.querySelector('#id_4bb25363-f5d3-4283-9b9b-9fd88b15bd78 button.colab-df-generate');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      buttonEl.onclick = () =\u003e {\n","        google.colab.notebook.generateWithVariable('train_df');\n","      }\n","      })();\n","    \u003c/script\u003e\n","  \u003c/div\u003e\n","\n","    \u003c/div\u003e\n","  \u003c/div\u003e\n"],"text/plain":["                                       FacilityName   Latitude   Longitude  \\\n","0                                  VISCOFAN USA INC  40.141389  -87.581111   \n","1     CORNWELL STATION - DOMINION TRANSMISSION, INC  38.475305  -81.278957   \n","2                     WEST UNION COMPRESSOR STATION  39.299820  -80.857170   \n","3                                DOUBLE \"C\" LIMITED  35.490363 -119.042957   \n","4                                   LAKESHORE PLANT  41.532802  -81.636448   \n","...                                             ...        ...         ...   \n","4650                  MIDLOTHIAN COMPRESSOR STATION  32.523334  -97.102556   \n","4651                    PARADISE COMPRESSOR STATION  42.684900 -109.780000   \n","4652            UNIV OF OK HEALTH S/OKC CAMPUS SVCS  35.484260  -97.498570   \n","4653         HARFORD CO. RESOURCE RECOVERY FACILITY  39.404310  -76.319820   \n","4654                    DCNR 595 COMPRESSOR STATION        NaN         NaN   \n","\n","             LocationAddress           City State         ZIP     County  \\\n","0         915 N MICHIGAN AVE       DANVILLE    IL       61832  VERMILION   \n","1       200 RIVER HAVEN ROAD      CLENDENIN    WV  25045-9304    KANAWHA   \n","2          3041 LONG RUN RD.      GREENWOOD    WV       26415    RITCHIE   \n","3        10245 OILFIELD ROAD    BAKERSFIELD    CA       93308       KERN   \n","4         6800 S MARGINAL RD      CLEVELAND    OH   441031047   CUYAHOGA   \n","...                      ...            ...   ...         ...        ...   \n","4650       2624 CHAMBERS ST.          VENUS    TX       76084    JOHNSON   \n","4651  SECTION 2, T31N, R109W       PINEDALE    WY       82941   SUBLETTE   \n","4652          800 NE 15TH ST  OKLAHOMA CITY    OK       73104   OKLAHOMA   \n","4653         1 MAGNOLIA ROAD          JOPPA    MD  21085-4800    HARFORD   \n","4654     1253 OLD ARNOT ROAD          ARNOT    PA       16911      TIOGA   \n","\n","      FIPScode  PrimaryNAICS  SecondPrimaryNAICS  \\\n","0      17183.0        326121                 NaN   \n","1      54039.0        486210                 NaN   \n","2      54085.0        211112                 NaN   \n","3       6029.0        221112                 NaN   \n","4      39035.0        221112                 NaN   \n","...        ...           ...                 ...   \n","4650   48251.0        211111                 NaN   \n","4651   56035.0        211111                 NaN   \n","4652   40109.0        611310                 NaN   \n","4653   24025.0        562213                 NaN   \n","4654   42117.0        211111                 NaN   \n","\n","                           IndustryType  TRI_Air_Emissions_10_in_lbs  \\\n","0                                 Other                 31566.709644   \n","1     Petroleum and Natural Gas Systems                          NaN   \n","2     Petroleum and Natural Gas Systems                          NaN   \n","3                          Power Plants                          NaN   \n","4                          Power Plants                 29553.796627   \n","...                                 ...                          ...   \n","4650  Petroleum and Natural Gas Systems                          NaN   \n","4651  Petroleum and Natural Gas Systems                          NaN   \n","4652                              Other                          NaN   \n","4653                              Waste                          NaN   \n","4654  Petroleum and Natural Gas Systems                          NaN   \n","\n","      TRI_Air_Emissions_11_in_lbs  TRI_Air_Emissions_12_in_lbs  \\\n","0                    26644.986107                 23410.379903   \n","1                             NaN                          NaN   \n","2                             NaN                          NaN   \n","3                             NaN                          NaN   \n","4                    28337.832145                 30840.825454   \n","...                           ...                          ...   \n","4650                          NaN                          NaN   \n","4651                          NaN                          NaN   \n","4652                          NaN                          NaN   \n","4653                          NaN                          NaN   \n","4654                          NaN                          NaN   \n","\n","      TRI_Air_Emissions_13_in_lbs  GHG_Direct_Emissions_10_in_metric_tons  \\\n","0                    31809.857564                            64816.958901   \n","1                             NaN                            55507.543666   \n","2                             NaN                                     NaN   \n","3                             NaN                            54811.222708   \n","4                    25153.901905                            81812.306362   \n","...                           ...                                     ...   \n","4650                          NaN                            54978.841280   \n","4651                          NaN                           208375.435367   \n","4652                          NaN                           563756.090695   \n","4653                          NaN                            67451.225733   \n","4654                          NaN                                     NaN   \n","\n","      GHG_Direct_Emissions_11_in_metric_tons  \\\n","0                               36588.744606   \n","1                               72387.334115   \n","2                                        NaN   \n","3                               69339.923002   \n","4                               53823.561587   \n","...                                      ...   \n","4650                            56463.765036   \n","4651                            57066.624445   \n","4652                           598881.479485   \n","4653                            27397.929966   \n","4654                                     NaN   \n","\n","      GHG_Direct_Emissions_12_in_metric_tons  \\\n","0                               3.790794e+04   \n","1                               5.822520e+04   \n","2                                        NaN   \n","3                               6.364734e+04   \n","4                               7.739116e+04   \n","...                                      ...   \n","4650                            3.522786e+06   \n","4651                            4.858030e+04   \n","4652                            1.665103e+06   \n","4653                            3.922795e+04   \n","4654                                     NaN   \n","\n","      GHG_Direct_Emissions_13_in_metric_tons  \\\n","0                               45598.125851   \n","1                               76376.547318   \n","2                                        NaN   \n","3                               53799.011225   \n","4                               17662.966241   \n","...                                      ...   \n","4650                            76642.640670   \n","4651                            26892.366779   \n","4652                           543206.073134   \n","4653                            46634.777768   \n","4654                                     NaN   \n","\n","      GHG_Direct_Emissions_14_in_metric_tons  TRI_Air_Emissions_YoY_Change_11  \\\n","0                               5.297314e+04                     -4921.723537   \n","1                               5.591007e+04                              NaN   \n","2                               5.567954e+04                              NaN   \n","3                               6.141190e+04                              NaN   \n","4                               4.310047e+04                     -1215.964481   \n","...                                      ...                              ...   \n","4650                            2.451197e+06                              NaN   \n","4651                            3.573974e+04                              NaN   \n","4652                            9.783592e+05                              NaN   \n","4653                            2.723434e+04                              NaN   \n","4654                            1.948221e+05                              NaN   \n","\n","      TRI_Air_Emissions_YoY_Change_12  TRI_Air_Emissions_YoY_Change_13  \\\n","0                        -3234.606204                      8399.477661   \n","1                                 NaN                              NaN   \n","2                                 NaN                              NaN   \n","3                                 NaN                              NaN   \n","4                         2502.993309                     -5686.923550   \n","...                               ...                              ...   \n","4650                              NaN                              NaN   \n","4651                              NaN                              NaN   \n","4652                              NaN                              NaN   \n","4653                              NaN                              NaN   \n","4654                              NaN                              NaN   \n","\n","      TRI_Air_Emissions_Growth_Rate_11  TRI_Air_Emissions_Growth_Rate_12  \\\n","0                            -0.155915                         -0.121396   \n","1                                  NaN                               NaN   \n","2                                  NaN                               NaN   \n","3                                  NaN                               NaN   \n","4                            -0.041144                          0.088327   \n","...                                ...                               ...   \n","4650                               NaN                               NaN   \n","4651                               NaN                               NaN   \n","4652                               NaN                               NaN   \n","4653                               NaN                               NaN   \n","4654                               NaN                               NaN   \n","\n","      TRI_Air_Emissions_Growth_Rate_13    G12/G10   G13/G11  \\\n","0                             0.358793   0.584846  1.246234   \n","1                                  NaN   1.048960  1.055109   \n","2                                  NaN        NaN       NaN   \n","3                                  NaN   1.161210  0.775874   \n","4                            -0.184396   0.945960  0.328164   \n","...                                ...        ...       ...   \n","4650                               NaN  64.075298  1.357377   \n","4651                               NaN   0.233138  0.471245   \n","4652                               NaN   2.953588  0.907034   \n","4653                               NaN   0.581575  1.702128   \n","4654                               NaN        NaN       NaN   \n","\n","      TRI_to_GHG_Ratio_10  TRI_to_GHG_Ratio_11  TRI_to_GHG_Ratio_12  \\\n","0                0.487013             0.728229             0.617559   \n","1                     NaN                  NaN                  NaN   \n","2                     NaN                  NaN                  NaN   \n","3                     NaN                  NaN                  NaN   \n","4                0.361239             0.526495             0.398506   \n","...                   ...                  ...                  ...   \n","4650                  NaN                  NaN                  NaN   \n","4651                  NaN                  NaN                  NaN   \n","4652                  NaN                  NaN                  NaN   \n","4653                  NaN                  NaN                  NaN   \n","4654                  NaN                  NaN                  NaN   \n","\n","      TRI_to_GHG_Ratio_13  \n","0                0.697613  \n","1                     NaN  \n","2                     NaN  \n","3                     NaN  \n","4                1.424104  \n","...                   ...  \n","4650                  NaN  \n","4651                  NaN  \n","4652                  NaN  \n","4653                  NaN  \n","4654                  NaN  \n","\n","[4655 rows x 33 columns]"]},"execution_count":177,"metadata":{},"output_type":"execute_result"}],"source":["train_df"]},{"cell_type":"code","execution_count":178,"metadata":{"executionInfo":{"elapsed":44,"status":"ok","timestamp":1731573842151,"user":{"displayName":"ねこ","userId":"00794682924380388788"},"user_tz":-540},"id":"HjbtM4RLXfG6"},"outputs":[],"source":["train = train_df[numerical_columns+lat_lon_columns+new_features1].values\n","test  = test_df[numerical_columns+lat_lon_columns+new_features1].values\n","target = train_df[target_columns].values"]},{"cell_type":"code","execution_count":179,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":390,"status":"ok","timestamp":1731573842498,"user":{"displayName":"ねこ","userId":"00794682924380388788"},"user_tz":-540},"id":"IV4UNOjgQEGg","outputId":"5b1265d6-4d5e-49c8-d6b9-276ba7909f02"},"outputs":[{"data":{"text/plain":["array([[3.15667096e+04, 2.66449861e+04, 2.34103799e+04, ...,\n","        3.58792881e-01, 5.84845963e-01, 1.24623368e+00],\n","       [           nan,            nan,            nan, ...,\n","                   nan, 1.04896006e+00, 1.05510927e+00],\n","       [           nan,            nan,            nan, ...,\n","                   nan,            nan,            nan],\n","       ...,\n","       [           nan,            nan,            nan, ...,\n","                   nan, 2.95358770e+00, 9.07034349e-01],\n","       [           nan,            nan,            nan, ...,\n","                   nan, 5.81575016e-01, 1.70212778e+00],\n","       [           nan,            nan,            nan, ...,\n","                   nan,            nan,            nan]])"]},"execution_count":179,"metadata":{},"output_type":"execute_result"}],"source":["train"]},{"cell_type":"code","execution_count":180,"metadata":{"executionInfo":{"elapsed":9,"status":"ok","timestamp":1731573842499,"user":{"displayName":"ねこ","userId":"00794682924380388788"},"user_tz":-540},"id":"cbZmf9mjVlEK"},"outputs":[],"source":["import lightgbm as lgb_module\n","from catboost import CatBoostRegressor\n","from sklearn.model_selection import KFold\n","from sklearn.metrics import mean_squared_error\n","def objective_lgb(trial):\n","    # Define your features and target\n","    feature_columns = numerical_columns + lat_lon_columns + new_features1\n","    X_train = train_df[feature_columns].values  # 特徴量の抽出\n","    y_train = train_df[target_columns].values.ravel()  # ターゲット変数を1次元配列に変換\n","\n","    # 確認: ターゲット変数が0以上であることを保証\n","    if np.any(y_train \u003c 0):\n","        raise ValueError(\"ターゲット変数に負の値が含まれています。RMSLEを計算するためには全てのターゲット値が0以上である必要があります。\")\n","\n","    # Initialize K-Fold\n","    kf = KFold(n_splits=3, shuffle=True, random_state=0)\n","\n","    # Initialize out-of-fold predictions\n","    oof = np.zeros(len(X_train))\n","\n","    # Iterate through each fold\n","    for fold, (train_idx, valid_idx) in enumerate(kf.split(X_train, y_train)):\n","        X_tr, X_val = X_train[train_idx], X_train[valid_idx]\n","        y_tr, y_val = y_train[train_idx], y_train[valid_idx]\n","\n","        # Suggest hyperparameters\n","        learning_rate = trial.suggest_float(\"learning_rate\", 0.01, 0.1)\n","        depth = trial.suggest_int(\"depth\", 2, 10)\n","        l2_leaf_reg = trial.suggest_float(\"l2_leaf_reg\", 1, 10)\n","\n","        # 回帰モデル用にモデルを初期化\n","        model = CatBoostRegressor(\n","        learning_rate=learning_rate,\n","        depth=depth,\n","        l2_leaf_reg=l2_leaf_reg,\n","        random_state=42,\n","        verbose=0\n","        )\n","\n","        # Fit the model\n","        model.fit(\n","            X_tr, y_tr,\n","            eval_set=[(X_val, y_val)]\n","        )\n","\n","        # Predict on validation set\n","        preds = model.predict(X_val)\n","\n","        # 確認: 予測値が0以上であることを保証\n","        preds = np.maximum(preds, 0)\n","\n","        oof[valid_idx] = preds\n","\n","    # Calculate RMSLE\n","    rmsle = mean_squared_log_error(y_train, oof, squared=False)  # squared=FalseでRMSE（RMSLE）を計算\n","\n","    return rmsle  # OptunaはRMSLEを最小化しようとします"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true,"base_uri":"https://localhost:8080/"},"id":"ybwNM8saVxks"},"outputs":[{"name":"stderr","output_type":"stream","text":["[I 2024-11-14 08:44:01,561] A new study created in memory with name: no-name-f5688542-564a-4e51-9b9a-7d74108a0916\n","[I 2024-11-14 08:45:10,785] Trial 0 finished with value: 0.8823743755072676 and parameters: {'learning_rate': 0.06449267234096039, 'depth': 8, 'l2_leaf_reg': 3.882644257981881}. Best is trial 0 with value: 0.8823743755072676.\n","[I 2024-11-14 08:45:28,663] Trial 1 finished with value: 0.9012451087097181 and parameters: {'learning_rate': 0.01960745521061579, 'depth': 6, 'l2_leaf_reg': 4.629555540239938}. Best is trial 0 with value: 0.8823743755072676.\n","[I 2024-11-14 08:45:33,636] Trial 2 finished with value: 0.9578179511783128 and parameters: {'learning_rate': 0.08714861691280147, 'depth': 3, 'l2_leaf_reg': 4.057729299475173}. Best is trial 0 with value: 0.8823743755072676.\n","[I 2024-11-14 08:45:54,567] Trial 3 finished with value: 0.9023081589375777 and parameters: {'learning_rate': 0.08590190933878387, 'depth': 6, 'l2_leaf_reg': 2.4557142165321935}. Best is trial 0 with value: 0.8823743755072676.\n","[I 2024-11-14 08:48:39,799] Trial 4 finished with value: 0.8781198459159074 and parameters: {'learning_rate': 0.04783092868652607, 'depth': 10, 'l2_leaf_reg': 4.119662209546005}. Best is trial 4 with value: 0.8781198459159074.\n","[I 2024-11-14 08:48:51,990] Trial 5 finished with value: 0.8890116297501635 and parameters: {'learning_rate': 0.017169441380149603, 'depth': 5, 'l2_leaf_reg': 3.9305006000626435}. Best is trial 4 with value: 0.8781198459159074.\n","[I 2024-11-14 08:49:21,891] Trial 6 finished with value: 0.900752910342908 and parameters: {'learning_rate': 0.04417127829259934, 'depth': 7, 'l2_leaf_reg': 4.916531113934511}. Best is trial 4 with value: 0.8781198459159074.\n","[I 2024-11-14 08:49:27,649] Trial 7 finished with value: 0.9146470370095908 and parameters: {'learning_rate': 0.022562566255714043, 'depth': 3, 'l2_leaf_reg': 3.9361893629786953}. Best is trial 4 with value: 0.8781198459159074.\n","[I 2024-11-14 08:49:36,327] Trial 8 finished with value: 0.9067921294765523 and parameters: {'learning_rate': 0.063761273715829, 'depth': 4, 'l2_leaf_reg': 5.521801128001564}. Best is trial 4 with value: 0.8781198459159074.\n","[I 2024-11-14 08:50:06,735] Trial 9 finished with value: 0.8926797405868545 and parameters: {'learning_rate': 0.03556560082280723, 'depth': 7, 'l2_leaf_reg': 2.993037613669208}. Best is trial 4 with value: 0.8781198459159074.\n","[I 2024-11-14 08:52:52,013] Trial 10 finished with value: 0.882433323578702 and parameters: {'learning_rate': 0.05022233560837182, 'depth': 10, 'l2_leaf_reg': 8.192479734946264}. Best is trial 4 with value: 0.8781198459159074.\n"]},{"name":"stdout","output_type":"stream","text":["RMSLE: 0.8781198459159074\n","Best parameters: {'learning_rate': 0.04783092868652607, 'depth': 10, 'l2_leaf_reg': 4.119662209546005}\n","--------------------------------------------------\n"]},{"data":{"text/html":["\u003cstyle\u003e#sk-container-id-5 {\n","  /* Definition of color scheme common for light and dark mode */\n","  --sklearn-color-text: black;\n","  --sklearn-color-line: gray;\n","  /* Definition of color scheme for unfitted estimators */\n","  --sklearn-color-unfitted-level-0: #fff5e6;\n","  --sklearn-color-unfitted-level-1: #f6e4d2;\n","  --sklearn-color-unfitted-level-2: #ffe0b3;\n","  --sklearn-color-unfitted-level-3: chocolate;\n","  /* Definition of color scheme for fitted estimators */\n","  --sklearn-color-fitted-level-0: #f0f8ff;\n","  --sklearn-color-fitted-level-1: #d4ebff;\n","  --sklearn-color-fitted-level-2: #b3dbfd;\n","  --sklearn-color-fitted-level-3: cornflowerblue;\n","\n","  /* Specific color for light theme */\n","  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n","  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));\n","  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));\n","  --sklearn-color-icon: #696969;\n","\n","  @media (prefers-color-scheme: dark) {\n","    /* Redefinition of color scheme for dark theme */\n","    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n","    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));\n","    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));\n","    --sklearn-color-icon: #878787;\n","  }\n","}\n","\n","#sk-container-id-5 {\n","  color: var(--sklearn-color-text);\n","}\n","\n","#sk-container-id-5 pre {\n","  padding: 0;\n","}\n","\n","#sk-container-id-5 input.sk-hidden--visually {\n","  border: 0;\n","  clip: rect(1px 1px 1px 1px);\n","  clip: rect(1px, 1px, 1px, 1px);\n","  height: 1px;\n","  margin: -1px;\n","  overflow: hidden;\n","  padding: 0;\n","  position: absolute;\n","  width: 1px;\n","}\n","\n","#sk-container-id-5 div.sk-dashed-wrapped {\n","  border: 1px dashed var(--sklearn-color-line);\n","  margin: 0 0.4em 0.5em 0.4em;\n","  box-sizing: border-box;\n","  padding-bottom: 0.4em;\n","  background-color: var(--sklearn-color-background);\n","}\n","\n","#sk-container-id-5 div.sk-container {\n","  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`\n","     but bootstrap.min.css set `[hidden] { display: none !important; }`\n","     so we also need the `!important` here to be able to override the\n","     default hidden behavior on the sphinx rendered scikit-learn.org.\n","     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */\n","  display: inline-block !important;\n","  position: relative;\n","}\n","\n","#sk-container-id-5 div.sk-text-repr-fallback {\n","  display: none;\n","}\n","\n","div.sk-parallel-item,\n","div.sk-serial,\n","div.sk-item {\n","  /* draw centered vertical line to link estimators */\n","  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));\n","  background-size: 2px 100%;\n","  background-repeat: no-repeat;\n","  background-position: center center;\n","}\n","\n","/* Parallel-specific style estimator block */\n","\n","#sk-container-id-5 div.sk-parallel-item::after {\n","  content: \"\";\n","  width: 100%;\n","  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);\n","  flex-grow: 1;\n","}\n","\n","#sk-container-id-5 div.sk-parallel {\n","  display: flex;\n","  align-items: stretch;\n","  justify-content: center;\n","  background-color: var(--sklearn-color-background);\n","  position: relative;\n","}\n","\n","#sk-container-id-5 div.sk-parallel-item {\n","  display: flex;\n","  flex-direction: column;\n","}\n","\n","#sk-container-id-5 div.sk-parallel-item:first-child::after {\n","  align-self: flex-end;\n","  width: 50%;\n","}\n","\n","#sk-container-id-5 div.sk-parallel-item:last-child::after {\n","  align-self: flex-start;\n","  width: 50%;\n","}\n","\n","#sk-container-id-5 div.sk-parallel-item:only-child::after {\n","  width: 0;\n","}\n","\n","/* Serial-specific style estimator block */\n","\n","#sk-container-id-5 div.sk-serial {\n","  display: flex;\n","  flex-direction: column;\n","  align-items: center;\n","  background-color: var(--sklearn-color-background);\n","  padding-right: 1em;\n","  padding-left: 1em;\n","}\n","\n","\n","/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is\n","clickable and can be expanded/collapsed.\n","- Pipeline and ColumnTransformer use this feature and define the default style\n","- Estimators will overwrite some part of the style using the `sk-estimator` class\n","*/\n","\n","/* Pipeline and ColumnTransformer style (default) */\n","\n","#sk-container-id-5 div.sk-toggleable {\n","  /* Default theme specific background. It is overwritten whether we have a\n","  specific estimator or a Pipeline/ColumnTransformer */\n","  background-color: var(--sklearn-color-background);\n","}\n","\n","/* Toggleable label */\n","#sk-container-id-5 label.sk-toggleable__label {\n","  cursor: pointer;\n","  display: block;\n","  width: 100%;\n","  margin-bottom: 0;\n","  padding: 0.5em;\n","  box-sizing: border-box;\n","  text-align: center;\n","}\n","\n","#sk-container-id-5 label.sk-toggleable__label-arrow:before {\n","  /* Arrow on the left of the label */\n","  content: \"▸\";\n","  float: left;\n","  margin-right: 0.25em;\n","  color: var(--sklearn-color-icon);\n","}\n","\n","#sk-container-id-5 label.sk-toggleable__label-arrow:hover:before {\n","  color: var(--sklearn-color-text);\n","}\n","\n","/* Toggleable content - dropdown */\n","\n","#sk-container-id-5 div.sk-toggleable__content {\n","  max-height: 0;\n","  max-width: 0;\n","  overflow: hidden;\n","  text-align: left;\n","  /* unfitted */\n","  background-color: var(--sklearn-color-unfitted-level-0);\n","}\n","\n","#sk-container-id-5 div.sk-toggleable__content.fitted {\n","  /* fitted */\n","  background-color: var(--sklearn-color-fitted-level-0);\n","}\n","\n","#sk-container-id-5 div.sk-toggleable__content pre {\n","  margin: 0.2em;\n","  border-radius: 0.25em;\n","  color: var(--sklearn-color-text);\n","  /* unfitted */\n","  background-color: var(--sklearn-color-unfitted-level-0);\n","}\n","\n","#sk-container-id-5 div.sk-toggleable__content.fitted pre {\n","  /* unfitted */\n","  background-color: var(--sklearn-color-fitted-level-0);\n","}\n","\n","#sk-container-id-5 input.sk-toggleable__control:checked~div.sk-toggleable__content {\n","  /* Expand drop-down */\n","  max-height: 200px;\n","  max-width: 100%;\n","  overflow: auto;\n","}\n","\n","#sk-container-id-5 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {\n","  content: \"▾\";\n","}\n","\n","/* Pipeline/ColumnTransformer-specific style */\n","\n","#sk-container-id-5 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {\n","  color: var(--sklearn-color-text);\n","  background-color: var(--sklearn-color-unfitted-level-2);\n","}\n","\n","#sk-container-id-5 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n","  background-color: var(--sklearn-color-fitted-level-2);\n","}\n","\n","/* Estimator-specific style */\n","\n","/* Colorize estimator box */\n","#sk-container-id-5 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {\n","  /* unfitted */\n","  background-color: var(--sklearn-color-unfitted-level-2);\n","}\n","\n","#sk-container-id-5 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {\n","  /* fitted */\n","  background-color: var(--sklearn-color-fitted-level-2);\n","}\n","\n","#sk-container-id-5 div.sk-label label.sk-toggleable__label,\n","#sk-container-id-5 div.sk-label label {\n","  /* The background is the default theme color */\n","  color: var(--sklearn-color-text-on-default-background);\n","}\n","\n","/* On hover, darken the color of the background */\n","#sk-container-id-5 div.sk-label:hover label.sk-toggleable__label {\n","  color: var(--sklearn-color-text);\n","  background-color: var(--sklearn-color-unfitted-level-2);\n","}\n","\n","/* Label box, darken color on hover, fitted */\n","#sk-container-id-5 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {\n","  color: var(--sklearn-color-text);\n","  background-color: var(--sklearn-color-fitted-level-2);\n","}\n","\n","/* Estimator label */\n","\n","#sk-container-id-5 div.sk-label label {\n","  font-family: monospace;\n","  font-weight: bold;\n","  display: inline-block;\n","  line-height: 1.2em;\n","}\n","\n","#sk-container-id-5 div.sk-label-container {\n","  text-align: center;\n","}\n","\n","/* Estimator-specific */\n","#sk-container-id-5 div.sk-estimator {\n","  font-family: monospace;\n","  border: 1px dotted var(--sklearn-color-border-box);\n","  border-radius: 0.25em;\n","  box-sizing: border-box;\n","  margin-bottom: 0.5em;\n","  /* unfitted */\n","  background-color: var(--sklearn-color-unfitted-level-0);\n","}\n","\n","#sk-container-id-5 div.sk-estimator.fitted {\n","  /* fitted */\n","  background-color: var(--sklearn-color-fitted-level-0);\n","}\n","\n","/* on hover */\n","#sk-container-id-5 div.sk-estimator:hover {\n","  /* unfitted */\n","  background-color: var(--sklearn-color-unfitted-level-2);\n","}\n","\n","#sk-container-id-5 div.sk-estimator.fitted:hover {\n","  /* fitted */\n","  background-color: var(--sklearn-color-fitted-level-2);\n","}\n","\n","/* Specification for estimator info (e.g. \"i\" and \"?\") */\n","\n","/* Common style for \"i\" and \"?\" */\n","\n",".sk-estimator-doc-link,\n","a:link.sk-estimator-doc-link,\n","a:visited.sk-estimator-doc-link {\n","  float: right;\n","  font-size: smaller;\n","  line-height: 1em;\n","  font-family: monospace;\n","  background-color: var(--sklearn-color-background);\n","  border-radius: 1em;\n","  height: 1em;\n","  width: 1em;\n","  text-decoration: none !important;\n","  margin-left: 1ex;\n","  /* unfitted */\n","  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n","  color: var(--sklearn-color-unfitted-level-1);\n","}\n","\n",".sk-estimator-doc-link.fitted,\n","a:link.sk-estimator-doc-link.fitted,\n","a:visited.sk-estimator-doc-link.fitted {\n","  /* fitted */\n","  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n","  color: var(--sklearn-color-fitted-level-1);\n","}\n","\n","/* On hover */\n","div.sk-estimator:hover .sk-estimator-doc-link:hover,\n",".sk-estimator-doc-link:hover,\n","div.sk-label-container:hover .sk-estimator-doc-link:hover,\n",".sk-estimator-doc-link:hover {\n","  /* unfitted */\n","  background-color: var(--sklearn-color-unfitted-level-3);\n","  color: var(--sklearn-color-background);\n","  text-decoration: none;\n","}\n","\n","div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,\n",".sk-estimator-doc-link.fitted:hover,\n","div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,\n",".sk-estimator-doc-link.fitted:hover {\n","  /* fitted */\n","  background-color: var(--sklearn-color-fitted-level-3);\n","  color: var(--sklearn-color-background);\n","  text-decoration: none;\n","}\n","\n","/* Span, style for the box shown on hovering the info icon */\n",".sk-estimator-doc-link span {\n","  display: none;\n","  z-index: 9999;\n","  position: relative;\n","  font-weight: normal;\n","  right: .2ex;\n","  padding: .5ex;\n","  margin: .5ex;\n","  width: min-content;\n","  min-width: 20ex;\n","  max-width: 50ex;\n","  color: var(--sklearn-color-text);\n","  box-shadow: 2pt 2pt 4pt #999;\n","  /* unfitted */\n","  background: var(--sklearn-color-unfitted-level-0);\n","  border: .5pt solid var(--sklearn-color-unfitted-level-3);\n","}\n","\n",".sk-estimator-doc-link.fitted span {\n","  /* fitted */\n","  background: var(--sklearn-color-fitted-level-0);\n","  border: var(--sklearn-color-fitted-level-3);\n","}\n","\n",".sk-estimator-doc-link:hover span {\n","  display: block;\n","}\n","\n","/* \"?\"-specific style due to the `\u003ca\u003e` HTML tag */\n","\n","#sk-container-id-5 a.estimator_doc_link {\n","  float: right;\n","  font-size: 1rem;\n","  line-height: 1em;\n","  font-family: monospace;\n","  background-color: var(--sklearn-color-background);\n","  border-radius: 1rem;\n","  height: 1rem;\n","  width: 1rem;\n","  text-decoration: none;\n","  /* unfitted */\n","  color: var(--sklearn-color-unfitted-level-1);\n","  border: var(--sklearn-color-unfitted-level-1) 1pt solid;\n","}\n","\n","#sk-container-id-5 a.estimator_doc_link.fitted {\n","  /* fitted */\n","  border: var(--sklearn-color-fitted-level-1) 1pt solid;\n","  color: var(--sklearn-color-fitted-level-1);\n","}\n","\n","/* On hover */\n","#sk-container-id-5 a.estimator_doc_link:hover {\n","  /* unfitted */\n","  background-color: var(--sklearn-color-unfitted-level-3);\n","  color: var(--sklearn-color-background);\n","  text-decoration: none;\n","}\n","\n","#sk-container-id-5 a.estimator_doc_link.fitted:hover {\n","  /* fitted */\n","  background-color: var(--sklearn-color-fitted-level-3);\n","}\n","\u003c/style\u003e\u003cdiv id=\"sk-container-id-5\" class=\"sk-top-container\"\u003e\u003cdiv class=\"sk-text-repr-fallback\"\u003e\u003cpre\u003eLGBMRegressor(depth=10, l2_leaf_reg=4.119662209546005,\n","              learning_rate=0.04783092868652607, n_estimators=1000,\n","              objective=\u0026#x27;binary\u0026#x27;, random_state=0, verbose=-1)\u003c/pre\u003e\u003cb\u003eIn a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. \u003cbr /\u003eOn GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.\u003c/b\u003e\u003c/div\u003e\u003cdiv class=\"sk-container\" hidden\u003e\u003cdiv class=\"sk-item\"\u003e\u003cdiv class=\"sk-estimator fitted sk-toggleable\"\u003e\u003cinput class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-5\" type=\"checkbox\" checked\u003e\u003clabel for=\"sk-estimator-id-5\" class=\"sk-toggleable__label fitted sk-toggleable__label-arrow fitted\"\u003e\u0026nbsp;LGBMRegressor\u003cspan class=\"sk-estimator-doc-link fitted\"\u003ei\u003cspan\u003eFitted\u003c/span\u003e\u003c/span\u003e\u003c/label\u003e\u003cdiv class=\"sk-toggleable__content fitted\"\u003e\u003cpre\u003eLGBMRegressor(depth=10, l2_leaf_reg=4.119662209546005,\n","              learning_rate=0.04783092868652607, n_estimators=1000,\n","              objective=\u0026#x27;binary\u0026#x27;, random_state=0, verbose=-1)\u003c/pre\u003e\u003c/div\u003e \u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e"],"text/plain":["LGBMRegressor(depth=10, l2_leaf_reg=4.119662209546005,\n","              learning_rate=0.04783092868652607, n_estimators=1000,\n","              objective='binary', random_state=0, verbose=-1)"]},"execution_count":181,"metadata":{},"output_type":"execute_result"}],"source":["# Create an Optuna study\n","study = optuna.create_study(\n","    direction='minimize'  # Fixing the seed for reproducibility\n",")\n","\n","# Optimize the study\n","study.optimize(objective_lgb, n_trials=11)\n","\n","# Display the best results\n","print(f\"RMSLE: {study.best_value}\")\n","print(f\"Best parameters: {study.best_params}\")\n","print(\"-\" * 50)\n","\n","# Retrieve the best parameters\n","best_params = study.best_params\n","best_params['objective'] = 'binary'\n","best_params['verbose'] = -1  # Suppress output\n","best_params['random_state'] = 0  # For reproducibility\n","\n","# Optional: Remove parameters that might not be needed or could cause issues\n","# For example, if Optuna didn't suggest 'n_estimators', set a default\n","best_params.setdefault('n_estimators', 1000)\n","best_params.setdefault('learning_rate', 0.1)\n","\n","# Initialize the final model with the best parameters\n","lgb = lgb_module.LGBMRegressor(**best_params)\n","feature_columns = numerical_columns + lat_lon_columns + new_features1\n","# Fit the final model on the entire dataset\n","lgb.fit(train_df[feature_columns].values, train_df[target_columns].values)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"-JXYI2TjXn_i"},"outputs":[],"source":["file_name = \"008_SMBC.csv\"\n","# 投稿ファイル作成\n","submit = pd.read_csv(path+\"sample_submission.csv\", header=None)\n","submit[1] = test_predictions\n","submit.to_csv(file_name, header=None, index=False)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"ayCJO8UiXy2-"},"outputs":[],"source":[]}],"metadata":{"colab":{"authorship_tag":"ABX9TyOVBnqCMBLxWM0p8fvyGaiO","name":"","version":""},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}